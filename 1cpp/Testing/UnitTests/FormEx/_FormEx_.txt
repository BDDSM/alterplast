
Перем 
		_РасширениеФормы,
		Журнал;

Функция Конт(Конт) Возврат Конт; КонецФункции // : Контекст
Функция Сам() Возврат Конт(Контекст); КонецФункции // : Контекст

// -------------------------------- -------------------------------------
Процедура Конструктор()                                   
	//лСервис	= СоздатьОбъект("Сервис"); // только для проверки загрузки ФормЕкс
	//лСервис = 0;
	_РасширениеФормы = СоздатьОбъект("РасширениеФормы");
	
	Журнал = СоздатьОбъект("ЖурналВызоваМетодов");
КонецПроцедуры // Конструктор

Процедура ПроверитьЗаголовокАтрибута(лНовыйАтрибут, Заголовок)
	Сам().ПроверитьРавенство(лНовыйАтрибут.Заголовок, Заголовок); // НовыйСтатик1
КонецПроцедуры	// ПроверитьЗаголовокАтрибута

Процедура ПроверитьЗаголовокАтрибута_Штатно(лНовыйАтрибут, Заголовок)
	лЗаголовок = Сам().КонтекстФормы.Форма.ПолучитьАтрибут(лНовыйАтрибут.Идентификатор).Заголовок();
	Сам().ПроверитьРавенство(лЗаголовок, Заголовок); // НовыйСтатик1
КонецПроцедуры	// ПроверитьЗаголовокАтрибута

Процедура ПроверитьСвойстваСтатика(лНовыйАтрибут, Идентификатор, фУжеИнициализирован = 1, Формула = "")
	Сам = Сам();

	Если фУжеИнициализирован = 0 Тогда
		Сам.ПроверитьРавенство(лНовыйАтрибут.Видимость, 0);
		//Сам.ПроверитьРавенство(лНовыйАтрибут.Заголовок, ""); // НовыйСтатик1
		Сам.ПроверитьРавенство(лНовыйАтрибут.Формула, Формула); // TODO проверка формулы должна быть отдельной
		//Сам.ПроверитьНеравенство(лНовыйАтрибут.Идентификатор, "");
	Иначе
		Сам.ПроверитьРавенство(лНовыйАтрибут.Видимость, 1);
		//Сам.ПроверитьРавенство(лНовыйАтрибут.Заголовок, Идентификатор); // НовыйСтатик1
		Сам.ПроверитьРавенство(лНовыйАтрибут.Формула, "ФормулаДля"+Идентификатор+"()");
		//Сам.ПроверитьРавенство(лНовыйАтрибут.Идентификатор, Идентификатор);
	КонецЕсли;

	Сам.ПроверитьРавенство(лНовыйАтрибут.Идентификатор, Идентификатор);
	
	Сам.ПроверитьРавенство(лНовыйАтрибут.Подсказка, "");
	Сам.ПроверитьРавенство(лНовыйАтрибут.Описание, "");
	Сам.ПроверитьРавенство(лНовыйАтрибут.Доступность, 0);
	Сам.ПроверитьРавенство(лНовыйАтрибут.Слой, "Основной");
	Сам.ПроверитьРавенство(лНовыйАтрибут.Тип, 1);
	Сам.ПроверитьРавенство(лНовыйАтрибут.ЦветШрифта, 0);
	Сам.ПроверитьРавенство(лНовыйАтрибут.Маска, "");
	Сам.ПроверитьРавенство(лНовыйАтрибут.ЦветФона, 16777215);
	//Сам.ПроверитьРавенство(лНовыйАтрибут.Шрифт, 1577718815); // разные значения
	Сам.ПроверитьРавенство(лНовыйАтрибут.Класс, "CStatic(0x40)->CWnd(0x40)->CCmdTarget(0x20)->CObject(0x4)->");
	Сам.ПроверитьРавенство(лНовыйАтрибут.Рамка, 0);
	//Сам.ПроверитьРавенство(лНовыйАтрибут.РодительскоеОкно, 0);
	Сам.ПроверитьБольше(лНовыйАтрибут.Дескриптор, 0);
	//Сам.ПроверитьРавенство(лНовыйАтрибут.Стиль, 1342308352);
	//Сам.ПроверитьРавенство(лНовыйАтрибут.РасширенныйСтиль, 1342308352);
	////Сам.ПроверитьРавенство(лНовыйАтрибут.Картинка, "");
	Сам.ПроверитьРавенство(лНовыйАтрибут.Фокус, 0);
	Сам.ПроверитьРавенство(лНовыйАтрибут.Автовыбор, 1);
	Сам.ПроверитьРавенство(лНовыйАтрибут.ИмеетКнопкуВыбора, 0);
КонецПроцедуры	// ПроверитьСвойстваСтатика

Процедура Тест_ДобавитьСтатикСФормулой() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	//лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибутСФормулой("НовыйСтатик1", 1, "ФормулаДляНовыйСтатик1()");

	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1", 0, "ФормулаДляНовыйСтатик1()");
	Форма.Обновить();

	лНовыйАтрибут.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут.Видимость = 1;

	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1");
	
	Форма.Обновить();

	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1");
	
	Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик1");

КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатик1_ПроверитьЗаголовок() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	//лНовыйАтрибут.Видимость = 1;
	//лНовыйАтрибут.Значение = "НовыйСтатик1";
	//Форма.Обновить();

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута_Штатно(лНовыйАтрибут, "НовыйСтатик1");
	Форма.Обновить();

	лНовыйАтрибут.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут.Значение = "НовыйСтатик1";
	//лНовыйАтрибут.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут.Видимость = 1;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута_Штатно(лНовыйАтрибут, "НовыйСтатик1");
	
	Форма.Обновить();

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	
	//Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::ФормулаДляНовыйСтатик1");

КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатик_ДваКонтрола_ПроверитьЗаголовок() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик2", 1);

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	лНовыйАтрибут1.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут1.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут1.Видимость = 1;

	лНовыйАтрибут2.Заголовок = "НовыйСтатик2";
	//лНовыйАтрибут2.Формула = "ФормулаДляНовыйСтатик2()";
	лНовыйАтрибут2.Видимость = 1;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	//Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2");

КонецПроцедуры

Процедура Тест_ДобавитьСтатик_ДваКонтрола() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	//лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	//лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик2", 1);
	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибутСФормулой("НовыйСтатик1", 1, "ФормулаДляНовыйСтатик1()");
	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибутСФормулой("НовыйСтатик2", 1, "ФормулаДляНовыйСтатик2()");

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1", 0, "ФормулаДляНовыйСтатик1()");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2", 0, "ФормулаДляНовыйСтатик2()");
	
	Форма.Обновить();

	лНовыйАтрибут1.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут1.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут1.Видимость = 1;

	лНовыйАтрибут2.Заголовок = "НовыйСтатик2";
	//лНовыйАтрибут2.Формула = "ФормулаДляНовыйСтатик2()";
	лНовыйАтрибут2.Видимость = 1;

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2");
	
	Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2, Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2");

КонецПроцедуры
    
Процедура ПроверитьСвойстваСтатикаШтатно(Форма, Идентификатор, фУжеИнициализирован = 1)
	Сам = Сам();
	
	лАтрибут = Форма.ПолучитьАтрибут(Идентификатор);
	
	Сам.ПроверитьРавенство(лАтрибут.Видимость(), 1);
	Сам.ПроверитьРавенство(лАтрибут.Доступность(), 1);
	Сам.ПроверитьРавенство(лАтрибут.Редактирование(), 0);
	Сам.ПроверитьРавенство(лАтрибут.Цвет(), 0);
	Сам.ПроверитьРавенство(ТипЗначения(лАтрибут.Маска()), 0);
	Сам.ПроверитьРавенство(лАтрибут.ВыборГруппы(), -1);
	Сам.ПроверитьРавенство(лАтрибут.ВыполнятьФормулуТолькоПриИзменении(), 0);
	Сам.ПроверитьРавенство(лАтрибут.НеИзменятьВид(), 0);
                                        
КонецПроцедуры	// ПроверитьСвойстваСтатикаШтатно

Процедура Тест_ДобавитьСтатик1_ПроверитьСвойстваШтатно() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);

	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1", 0);
	
	Форма.Обновить();

	Форма.ПолучитьАтрибут("НовыйСтатик1").Заголовок("НовыйСтатик1");
	
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1");
	
	Форма.Обновить();

	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1");
	
	//Сам.ПроверитьРавенство(ТипЗначения(Журнал.стрЖурнал), 0);

	//Сам.ЗакрытьФорму();
КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатик_ДваКонтрола_ПроверитьСвойстваШтатно() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);

	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик2", 1);
//Предупреждение("1");
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1", 0);
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик2", 0);
	Форма.Обновить();

	Форма.ПолучитьАтрибут("НовыйСтатик1").Заголовок("НовыйСтатик1");
	Форма.ПолучитьАтрибут("НовыйСтатик2").Заголовок("НовыйСтатик2");
	
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1");
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик2");
	
//Предупреждение("2");
	Форма.Обновить();	

	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик1");
	ПроверитьСвойстваСтатикаШтатно(Форма, "НовыйСтатик2");
	
	//Сам.ПроверитьРавенство(ТипЗначения(Журнал.стрЖурнал), 0);
//Предупреждение("3");

	//Сам.ЗакрытьФорму();

КонецПроцедуры
//
//Процедура Тест_ДобавитьСтатик1_ШтатныйУжеСуществует() Экспорт
//	Сам = Сам();
//
//	//Сам.ПропуститьТест();
//
//	Параметр = Журнал;
//                                
//	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1_ШтатныйУжеСуществует.ert";
//	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
//	
//	Форма = КонтФормы.Форма;
//
//	_РасширениеФормы.УстановитьФорму(Форма);
//
//	лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
//	
//	лНовыйАтрибут.Видимость = 1;
//	лНовыйАтрибут.Значение = "НовыйСтатик1";
//	
//	Хендл = лНовыйАтрибут.Handle;
//	UserWrap = СоздатьОбъект("DynamicWrapper");
//	UserWrap.Register("USER32.DLL", "GetWindowText", "i=lrl", "f=s", "r=l");
//	    
//	сТекстОкна = "";
//	Для к=1 По 255 Цикл
//		сТекстОкна = сТекстОкна + " ";
//	КонецЦикла;
//	Количество = UserWrap.GetWindowText(Хендл, сТекстОкна, 254);
//Сообщить("Хендл = <"+Хендл+">"+"  "+"сТекстОкна = <"+сТекстОкна+">");
//Сообщить("Количество = <"+Количество+">");
//
//
//	UserWrap.Register("USER32.DLL", "GetForegroundWindow", "f=s", "r=l");
//	//Хендл = UserWrap.GetForegroundWindow();
//	Количество = UserWrap.GetWindowText(Хендл, сТекстОкна, 254);
//Сообщить("Хендл = <"+Хендл+">"+"  "+"сТекстОкна = <"+сТекстОкна+">");
//Сообщить("Количество = <"+Количество+">");
//
////Const WM_GETTEXT = &HD          
//WM_GETTEXT = 14;
////Set Wrap = CreateObject("DynamicWrapper")
////Wrap.Register "USER32.DLL", "GetForegroundWindow", "f=s", "r=l"
//UserWrap.Register("USER32.DLL", "SendMessage", "i=lllr", "f=s", "r=l");
////Title = Space(100)
////res = Wrap.SendMessage(Wrap.GetForegroundWindow(), WM_GETTEXT , 100, Title)
////MsgBox Title 
//Количество = UserWrap.SendMessage(Хендл, WM_GETTEXT , 100, сТекстОкна);
//Сообщить("Хендл = <"+Хендл+">"+"  "+"сТекстОкна = <"+сТекстОкна+">");
//Сообщить("Количество = <"+Количество+">");
//
//сТекстОкна = _РасширениеФормы.ТестНазначитьТип(Хендл);
//Сообщить("Хендл = <"+Хендл+">"+"  "+"сТекстОкна = <"+сТекстОкна+">");
//
//UserWrap.Register("USER32.DLL", "ShowWindow", "i=ll", "f=s", "r=l");
//SW_SHOW = 5;            
//SW_HIDE = 0;
//фУспеха = UserWrap.ShowWindow(Хендл, SW_SHOW);
//фУспеха = UserWrap.ShowWindow(Хендл, SW_HIDE);
//фУспеха = UserWrap.ShowWindow(Хендл, SW_SHOW);
//
//	лСуществующийАтрибут = _РасширениеФормы.ПолучитьАтрибут("статикТекст");
//	Хендл = лСуществующийАтрибут.Handle;
//сТекстОкна = _РасширениеФормы.ТестНазначитьТип(Хендл);
//Сообщить("существующий Хендл = <"+Хендл+">"+"  "+"сТекстОкна = <"+сТекстОкна+">");
//фУспеха = UserWrap.ShowWindow(Хендл, SW_HIDE);
//Предупреждение(сТекстОкна);
//Возврат;
//
//	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1", 0);
//	Форма.Обновить();
//
//	лНовыйАтрибут.Заголовок = "НовыйСтатик1";
//	лНовыйАтрибут.Формула = "ФормулаДляНовыйСтатик1()";
//	лНовыйАтрибут.Видимость = 1;
//
//	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1");
//	
//	Форма.Обновить();
//
//	ПроверитьСвойстваСтатика(лНовыйАтрибут, "НовыйСтатик1");
//	
//	Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::Текст, Форма::Текст, Форма::Текст, Форма::ФормулаДляНовыйСтатик1");
//КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатикДваКонтрола_ШтатныйУжеСуществует() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1_ШтатныйУжеСуществует.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

//	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
//	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик2", 1);
	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибутСФормулой("НовыйСтатик1", 1, "ФормулаДляНовыйСтатик1()");
	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибутСФормулой("НовыйСтатик2", 1, "ФормулаДляНовыйСтатик2()");

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1", 0, "ФормулаДляНовыйСтатик1()");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2", 0, "ФормулаДляНовыйСтатик2()");
	
	Форма.Обновить();

	лНовыйАтрибут1.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут1.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут1.Видимость = 1;

	лНовыйАтрибут2.Заголовок = "НовыйСтатик2";
	//лНовыйАтрибут2.Формула = "ФормулаДляНовыйСтатик2()";
	лНовыйАтрибут2.Видимость = 1;

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	ПроверитьСвойстваСтатика(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьСвойстваСтатика(лНовыйАтрибут2, "НовыйСтатик2");
	
	//Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::Текст, Форма::Текст, Форма::Текст, Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2");
	Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::Текст, Форма::Текст, Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2, Форма::Текст, Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2");
КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатик1_ШтатныйУжеСуществует_ПроверитьЗаголовок() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1_ШтатныйУжеСуществует.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);

//Сообщить("Тест_ДобавитьСтатик1_ШтатныйУжеСуществует_ПроверитьЗаголовок = ");	
	//Сам.КонтекстФормы = 0;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	Форма.Обновить();

	лНовыйАтрибут.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут.Видимость = 1;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	
	Форма.Обновить();

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут, "НовыйСтатик1");
	
	//Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::Текст, Форма::Текст, Форма::Текст, Форма::ФормулаДляНовыйСтатик1");
КонецПроцедуры	// Тест_ДобавитьСтатик1 

Процедура Тест_ДобавитьСтатикДваКонтрола_ШтатныйУжеСуществует_ПроверитьЗаголовок() Экспорт
	Сам = Сам();

	//Сам.ПропуститьТест();

	Параметр = Журнал;
                                
	ПутьКТестовойФорме = КаталогИБ()+"UnitTests\FormEx\FormEx_ДобавитьАтрибут1_ШтатныйУжеСуществует.ert";
	КонтФормы = Сам.ОткрытьФорму("Отчет#", Параметр, ПутьКТестовойФорме);
	
	Форма = КонтФормы.Форма;

	_РасширениеФормы.УстановитьФорму(Форма);

	лНовыйАтрибут1 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик1", 1);
	лНовыйАтрибут2 =	_РасширениеФормы.ДобавитьАтрибут("НовыйСтатик2", 1);

//Сообщить("Тест_ДобавитьСтатикДваКонтрола_ШтатныйУжеСуществует_ПроверитьЗаголовок = ");	
	//Сам.КонтекстФормы = 0;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	лНовыйАтрибут1.Заголовок = "НовыйСтатик1";
	//лНовыйАтрибут1.Формула = "ФормулаДляНовыйСтатик1()";
	лНовыйАтрибут1.Видимость = 1;

	лНовыйАтрибут2.Заголовок = "НовыйСтатик2";
	//лНовыйАтрибут2.Формула = "ФормулаДляНовыйСтатик2()";
	лНовыйАтрибут2.Видимость = 1;

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	Форма.Обновить();

	ПроверитьЗаголовокАтрибута(лНовыйАтрибут1, "НовыйСтатик1");
	ПроверитьЗаголовокАтрибута(лНовыйАтрибут2, "НовыйСтатик2");
	
	//Сам.ПроверитьРавенство(Журнал.стрЖурнал, "Форма::Текст, Форма::Текст, Форма::Текст, Форма::ФормулаДляНовыйСтатик1, Форма::ФормулаДляНовыйСтатик2");
КонецПроцедуры	// Тест_ДобавитьСтатик1 
