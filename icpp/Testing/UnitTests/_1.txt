// проверка бага http://cvs.alterplast.ru/bugs/show_bug.cgi?id=2216
// 1C++ падает при повторной загрузке

Функция Конт(Конт) Возврат Конт; КонецФункции // : Контекст
Функция Сам() Возврат Конт(Контекст); КонецФункции // : Контекст

Процедура Тест_ПовторнаяЗагрузка() Экспорт                                                           
	// оказывается, для метода ЗагрузитьВнешнююКомпоненту регистр важен !!
	//т.е. если вначале выполнено
	//ЗагрузитьВК("1cpp.dll");
	//то повторная
	//фРез = ЗагрузитьВК("1cpp.dll");
	//выдаст 0
	//а
	//фРез = ЗагрузитьВК("1CPP.dll");
	//выдаст 1          
	
	ЗагрузитьВнешнююКомпоненту("1cpp.dll");
	// блин, Михаил, ты как тесты-то проверяешь, перед тем, как что-то менять, а?
	// этот тест давно работал, а из-за тебя перестал
	                                     
	// не нужно никаких проверок, главное, вылетит ВК или нет
КонецПроцедуры	// Тест_ПовторнаяЗагрузка

Процедура Тест_ПовторноеПодключение() Экспорт
	фРез1 = ПодключитьВнешнююКомпоненту("Addin.1c++");
	Сам().ПроверитьРавенство(фРез1, 0);
КонецПроцедуры
