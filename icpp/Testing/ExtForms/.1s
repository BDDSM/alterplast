ѕерем ∆урнал;
ѕерем г»м€_NETControl;

ѕерем ѕараметры;

ѕроцедура »ƒќбъектајктив»кс_BeforeNavigate2(объект,урл,флаги,фрейм,пост,заголовки,отмена)
//ѕредупреждение("123");
	∆урнал.ƒобавить«апись("‘орма::—обытие::»ƒќбъектајктив»кс_BeforeNavigate2");
	∆урнал.ƒобавить«апись("URL="+урл);

	отмена=-1; // не выводить в форму - так быстрее
 онецѕроцедуры

ѕроцедура ѕриќткрытии()

	∆урнал = —оздатьќбъект("∆урнал¬ызоваћетодов");
          
	ѕараметры = ‘орма.ѕараметр;

	≈сли ѕараметры = "”становитьјтрибут¬‘ормеѕриќткрытии" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс"); // должно быть исключение

	»наче≈сли ѕараметры = "Ќе¬ыполн€ть”становить‘орму" “огда

	»наче
		ќбъект‘орма = —оздатьќбъект("‘орма");
		ќбъект‘орма.”становить‘орму(‘орма); // чтобы вызывалось ‘ормаѕри—оздании
		∆урнал.ƒобавить«апись("‘орма.”становить‘орму");

	 онец≈сли;
	

	‘орма.ѕараметр = ∆урнал;
	
 онецѕроцедуры

// событие любого объекта "‘орма"
ѕроцедура ‘ормаѕри—оздании(»сточник) Ёкспорт
		∆урнал.ƒобавить«апись("‘орма::‘ормаѕри—оздании");
		
	≈сли ѕараметры = "—оздатьќбъект" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс="+“ип«начени€—тр(ќбъектјктив»кс));
	
	»наче≈сли ѕараметры = "”становитьјтрибут" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма, "»ƒќбъектајктив»кс");
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс::”становитьјтрибут");

	»наче≈сли ѕараметры = "—оздатьЁ”¬‘орме" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс");
		ќбъектјктив»кс.—оздатьЁ”("Shell.Explorer.2");

		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс="+“ип«начени€—тр(ќбъектјктив»кс.ќбъект));

		ќбъектјктив»кс.”ничтожить();
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс="+“ип«начени€—тр(ќбъектјктив»кс.ќбъект));

	»наче≈сли ѕараметры = "Ё”¬ыполнитьћетодќбъекта" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс");
		ќбъектјктив»кс.—оздатьЁ”("Shell.Explorer.2");

		ќбъектјктив»кс.ќбъект.Navigate("http://www.1cpp.ru");
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс::Navigate");

	»наче≈сли ѕараметры = "Ё”¬ыполнитьћетодќбъекта»ƒƒругой" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒƒругой");
		ќбъектјктив»кс.—оздатьЁ”("Shell.Explorer.2");

		ќбъектјктив»кс.ќбъект.Navigate("http://www.1cpp.ru");
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс::Navigate");

	»наче≈сли ѕараметры = "Ё”¬ыполнитьћетодќбъектаѕосле”ничтожени€" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс");
		ќбъектЁ” = ќбъектјктив»кс.—оздатьЁ”("Shell.Explorer.2");

		ќбъектјктив»кс.”ничтожить();
		ѕопытка
			ќбъектЁ”.Navigate("http://www.1cpp.ru");
		»сключение
			∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс::Navigate неудача");
		 онецѕопытки;

	»наче≈сли ѕараметры = "¬ернутьЁ”»з‘ормы" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс");
		//ќбъектјктив»кс.—оздатьЁ”("Shell.Explorer.2");
                                      
		‘орма.ѕараметр = ќбъектјктив»кс;
		//∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс="+“ип«начени€—тр(ќбъектјктив»кс.ќбъект));

		//ќбъектјктив»кс.”ничтожить();
		//∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс="+“ип«начени€—тр(ќбъектјктив»кс.ќбъект));

	»наче≈сли ѕараметры = "Ё”_NETControl_¬ыполнитьћетодќбъекта" “огда
		ќбъектјктив»кс = —оздатьќбъект("јктив»кс");
		ќбъектјктив»кс.”становитьјтрибут(‘орма,"»ƒќбъектајктив»кс");
		ѕопытка
			 онтрол = ќбъектјктив»кс.—оздатьЁ”(г»м€_NETControl);
		»сключение
			‘орма.ѕараметр = "ќшибка создани€ объекта "+г»м€_NETControl;
		 онецѕопытки;

		//ќбъектјктив»кс.ќбъект.Navigate("http://www.1cpp.ru");
		 онтрол.Val = "MyVal537";
		∆урнал.ƒобавить«апись("‘орма::ќбъектјктив»кс::AssignVal<"+ онтрол.Val+">");
		
	 онец≈сли; 

 онецѕроцедуры

//ѕроцедура »ƒќбъектајктив»кс_BeforeNavigate2(объект,урл,флаги,фрейм,пост,заголовки,отмена)
////ѕредупреждение("123");
//	∆урнал.ƒобавить«апись("‘орма::—обытие::»ƒќбъектајктив»кс_BeforeNavigate2");
//	∆урнал.ƒобавить«апись("URL="+урл);
//
//	отмена=-1; // не выводить в форму - так быстрее
// онецѕроцедуры
                                                   
// специально мало параметров !!
ѕроцедура »ƒƒругой_BeforeNavigate2(объект) // Ёкспорт
	∆урнал.ƒобавить«апись("‘орма::—обытие::»ƒƒругой_BeforeNavigate2");
 онецѕроцедуры

ѕроцедура —формировать()

 онецѕроцедуры

ѕроцедура »ƒќбъектајктив»кс_ValChanged()
	∆урнал.ƒобавить«апись("‘орма::—обытие::»ƒќбъектајктив»кс_ValChanged");
 онецѕроцедуры

ѕроцедура »ƒƒругой_ValChanged()
	∆урнал.ƒобавить«апись("‘орма::—обытие::»ƒƒругой_ValChanged");
 онецѕроцедуры

г»м€_NETControl = "_1cppTest.UserControl1";