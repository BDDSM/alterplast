<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
 <head>
  <link rel="stylesheet" href="styles.css" type="text/css">
  <title>
   О проекте...
  </title>
 </head>
 <body>
  <table width="100%" border="0" cellspacing="2" cellpadding="0">
   <tr>
    <td class="GrayTitle">
     О проекте
    </td>
   </tr>
   <tr>
    <td valign="top" class="Simple">
     <center>
      Что такое <b>&quot;Открытый Конфигуратор&quot;</b>
     </center>
     <p>
      Как известно, &quot;1С-Предприятие 7.7&quot; продукт хороший и
      распространенный. И основной его козырь - открытость платформы. Там,
      где штатных функций програмы не хватает, всегда есть лазейка в виде
      <b>&quot;Внешних Компонент&quot;</b>. А с выходом проекта
      <b>&quot;Rainbow&quot;</b> возможности ВК стали поистине безграничны.
     </p>
     <p>
      <a href="macros.htm">Теперь о грустном</a>. Все эти возможности
      затрагивают только пользовательскую часть программы. А мы, те кто
      заставляют работать ВК на радость юзеров, большую часть времени
      проводим отнюдь не в Предприятии, а в Конфигураторе. А здесь все
      плачевнее. Штатных методов для загрузки дополнительных модулей нет.
      Соответственно, нет и никаких стандартных интерфейсов типа
      ILanguageExtender и т.п. Может, на момент выхода Конфигуратор и
      удовлетворял програмистов по своим возможностям, но на сегодняшний
      день их уже явно недостачоно.
     </p>
     <p>
      С целью преодолеть все эти ограничения мной и был задуман этот
      проект.<br>
       Первоначально <b>OpenConf</b> предназначался только для загрузки
      сторонних dll в адресное пространство Конфигуратора. Теперь я
      планирую несколько расширить его возможности. К их числу относятся:
     </p>
     <ul type="square" compact>
      <li>
       <div class="Head">
        <a href="objects/objects.htm">Объектная модель
        Конфигуратора</a><br>
       </div>
       Позволяет обращатся к объектам Конфигуратора из скриптов и плагинов.
      </li>
      <li style="list-style: none">
       <hr>
      </li>
      <li>
       <div class="Head">
        <a href="scripts/scripts.htm">Использование ActiveScript</a><br>
       </div>
       Применение технологии ActiveScripting в Конфигуаторе позволяет
       програмно управлять им с помощью скриптов.
      </li>
      <li style="list-style: none">
       <hr>
      </li>
      <li>
       <div class="Head">
        <a href="plugins/plugins.htm">Новая архитектура плагинов</a><br>
       </div>
       Позволяет с легкостью писать плагины для Конфигуратора на любом из
       языков, способных работать с IDispatch и OLE Automation. Простой
       стандартный метод визуализации плагинов при помощи ActiveX Control
      </li>
      <li style="list-style: none">
       <hr>
      </li>
     </ul>
     <center>
      <div class="Head">
       <b>Основные принципы работы OpenConf</b>
      </div>
     </center>
     В основу механизма <b>OpenConf</b> положен способ подмены библиотеки
     <b>config.dll</b>, используемой 1С-Предприятием для работы
     Конфигуратора. Вместо &quot;родной&quot; <b>config.dll</b> загружается
     подменная, которая, оказываясь в адресном пространстве процесса,
     получает возможность выполнять дополнительные действия в программе и в
     свою очередь загружает &quot;родную&quot; config.dll для обеспечения
     штатной работы.<br>
      Основополагающий принцип работы основан на том факте, что большая
     часть функционала 1С-Предприятия размещена в библиотеках dll,
     экспортирующих свои функции по именам. Это позволяет воссоздать
     заголовочные файлы и библиотеки импорта для этих dll и в дальнейшем
     обращатся к ним также, как это делается самой программой 1С. Впервые
     такой подход был применен в ВК <b>&quot;Rainbow&quot;</b> Валерия
     Атаманюка.<br>
      Немаловажно и то, что сама 1С-Предприятие написана с использованием
     библиотеки MFC, исходные коды которой открыты. Это позволяет во многих
     случаях понять принципы работы программы и уточнить заголовки классов,
     полученных из экспортируемых функций dll 1С-Предприятия. 
     <p>
     </p>
     <div class="Note" id="tip" onclick="">
      <b>Примечание</b><br>
       При реализации методов <b>OpenConf</b> я старался по большей части
      пользоваться &quot;штатными&quot; функциями 1С, доступными через ее
      dll. <b>OpenConf</b> не работает напрямую с файлом метаданных, не
      парсит Main MetaDataStream, не считает CRC и тп. Для выполнения своих
      действий он просто обращается к &quot;внутренним&quot; функциям 1С.
      По сути дела, объектная модель OpenConf просто OLE-обертка вокруг C++
      объектов 1С.
     </div>
     <br>
     <br>
      
     <p>
      С уважением, <a href="mailto:openconf@narod.ru">Александр Орефков</a>
     </p>
    </td>
   </tr>
  </table>
 </body>
</html>

