<HTML>
<head>
<LINK REL=stylesheet HREF="../styles.css" TYPE="text/css">
<title>Плагины</title>
<script src=menu.js></script>
</head>
<body>
<table width=100% border=0 cellspacing=2 cellpadding=0>
 <tr>
  <td class=GrayTitle>
     Плагины
  </td>
 </tr>
 <tr>
  <td class=Simple>
  <b>Плагины</b> - дополнительные програмные модули, подключаемые к <b>OpenConf</b>. Представляют из себя dll, размещенные в каталоге <b>config</b>.<br>
Инициализация плагинов производится по разному взависимости от типа плагина.<br>
Принцип обработки следующий:
<ul type="square">
    <li><div><b>Просмотр каталога config</b></div>
При загрузке Конфигуратора <b>OpenConf</b> просматривает каталог <b>config</b>, загружая все dll, которые там расположены.</li><hr>
    <li><div><b>Поиск строкового ресурса с ID=100</b></div>
В каждой загруженной dll ищется строковой ресурс с <b>ID=100</b>. Если такой ресурс отсутствует, плагин рассматривается как <a href="#SimpleDLL">обычная DLL</a>. В этом случае в dll ищется экспортируемая функция <b>SetConvigService</b>, и если такая функция найдена, то она вызывается, передавая плагину указатель на объект <b>CConfigService</b>, через который плагин может обратиться к различным методам <b>OpenConf</b>.</li><hr>
	<li><div><b>Если строковый ресурс найден</b>,</div><b>OpenConf</b> пытается создать <b>OLE объект</b> с ProgID (CLSID), указанным в ресурсе. Минимальное требование к объекту - поддержка интерфеса IDispatch. Если попытка создать объект с указанным ProgID неудачна, OpenConf пытается зарегистрировать данную dll в реестре, вызывая функцию <b>DllRegisterServer</b></li><hr>
	<li><div><b>Инициализация загруженных OLE-плагинов.</b></div>
Для получения доступа к объектной модели Конфигуратора, плагин должен реализовать интерфейс <a href="icfgplugin.htm">IConfigPlugin</a>. При выполнении этого условия плагин рассматривается как <b>Совместимый</b>. Для него вызывается метод <a href="icfgplugin.htm#Init">IConfigPlugin::Init</a>, передавая в качестве параметра объект <a href="../objects/config.htm">Configurator</a>. Как результат метода плагин может вернуть свое название, под которым он будет зарегистрирован в списке плагинов. Также для него вызывается <a href="icfgplugin.htm#Caps">IConfigPlugin::GetPluginCaps</a>, запрашивая разнообразные параметры его поведения.</li><hr>
	<li><div><b>Визуальное представление плагина.</b></div>
Плагин может представлять из себя ActiveX контрол, который может быть отображен в Конфигураторе.<br>
Возможны два варианта отображения плагина.
<ul type="circle">
    <li>Отображение в правой панели страницы <b>OpenConf</b><br>
Применяется для ActiveX контролов, не реализующих интерфейс <a href="icfgplugin.htm">IConfigPlugin</a>, а также если плагин задал такое поведение в методе <a href="icfgplugin.htm#Caps">IConfigPlugin::GetPluginCaps</a></li>
    <li>Отображение отдельной вкладкой в окне Конфигурации<br>
	Применяется для ActiveX контролов, реализующих IConfigPlugin, и задавших такое поведение в методе <a href="icfgplugin.htm#Caps">IConfigPlugin::GetPluginCaps</a></li>
		</ul>
	</li><hr>
	<li><div><b>Отображение макросов плагина</b></div>
Для каждого плагина по умолчанию в дереве OpenConf отображается список его <a href="../macros.htm">макросов</a>. Для отмены этого плагин должен явно запретить их отображение в методе <a href="icfgplugin.htm#Caps">IConfigPlugin::GetPluginCaps</a>.</li><hr>
	<li><div><b>Иконка плагина</b></div>
При отображении плагина в дереве <b>OpenConf</b> использует иконки, размещенные в dll-файле плагина. Если файл не содержит иконок, используется стандартный системный значок. По умолчанию используется иконка, размещенная первой в файле. Плагин может явно указать номер иконки в методе <a href="icfgplugin.htm#Caps">IConfigPlugin::GetPluginCaps</a>.</li>
</ul> 
  </td>
 </tr>
 <tr>
  <td class=GrayTitle>
  Типы плагинов и требования к ним.
  </td>
 </tr>
 <tr>
  <td class=Simple>
  <a name="SimpleDLL"></a><b><center>Обычная DLL</center></b><br><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

  
  </td>
 </tr>
</table>

</BODY>
</HTML>
