<html><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>SciColorer</title>
<meta name="keywords" content="плагин OColorer SciColorer OpenConf 1С:Предприятие">
<meta name="description" content="Плагин SciColorer для платформы OpenConf">
<style type="text/css"> 
	.paragraph {text-align:justify; text-indent:2em; margin-top:0; margin-bottom:0}
</style>
</head>
<body bgcolor=#E0E0E0>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>
<p><a href="http://forum.script-coding.com">ФОРУМ (здесь можно обсудить эту статью, а также любые
проблемы программирования на различных макроязыках и в скриптовых средах)</a></p>

<h1>Плагин SciColorer для платформы OpenConf</h1>

<p class="paragraph">
<i>Данная статья последовательно описывает историю развития плагина и дополняется по мере выхода новых версий. За время своего развития плагин изменился очень существенно. Если Вы здесь впервые, внимательно прочитайте до конца, не скачивайте первую попавшуюся версию.</i>
</p>

<p class="paragraph">
Автор плагина - Бердаков Дмитрий.
</p>

<h2 style="text-indent:1.3em">Назначение и установка</h2>

<p class="paragraph">
Плагин отрисовывает gutter (вертикальная полоска слева в текстовом редакторе Конфигуратора) и предоставляет следующий функционал:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Подсвечивает "парные" синтаксические конструкции (скобки, Если...КонецЕсли и т.п.).</LI>
<LI>Обеспечивает возможность быстрого перехода к "парной скобке" синтаксической конструкции (переход по скобкам, переход с "Если" на "КонецЕсли" и т.п.).</LI>
<LI>Обеспечивает возможность быстрого выделения блока текста между "парными скобками".</LI>
<LI>Обеспечивает возможность быстрого выделения блока текста внутри "парных скобок", без самих скобок.</LI>
<LI>Обеспечивает возможность выделение блока текста мышью с использованием клавиши Shift.</LI>
<LI>Обеспечивает возможность вызывать codejump плагина Телепат по Ctrl+click на слове.</LI>
<LI>Показывает границы процедур и функций на gutter'е и обеспечивает возможность свёртки/развёртки текста процедур и функций (code folding).</LI>
</UL>

<p class="paragraph">
Установка:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Скопируйте файл <b>OColorer.dll</b> в подкаталог <b>\BIN\Config\</b> каталога установки 1С:Предприятия.</LI>
<LI>Скопируйте файл скрипта <b>OColorer.vbs</b> в подкаталог <b>config\scripts\OColorer\</b> каталога исполняемых файлов 1С:Предприятия. Примечание: в принципе, папку "OColorer" можно и не создавать, положив скрипт прямо в "config\scripts\".</LI>
<LI>Если 1С:Предприятие было запущено, перезапустите его.</LI>
</UL>

<p class="paragraph">
Примечание: использовать плагин без скрипта невозможно.
</p>

<h2 style="text-indent:1.3em">Использование</h2>

<p class="paragraph">
Свёртка/развёртка процедур и функций стала результатом скорее интереса, чем практического использования, т.к. у неё много "особенностей", связанных с редактором текстов модулей Конфигуратора:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>При свёртке/развёртке процедур фактически удаляется/добавляется текст документа, отсюда появление признака модифицированности и связанные с этим вопросы о сохранении при закрытии.</LI>
<LI>Не отлавливается момент Undo и другие программные изменения документа,
т.е. свернули процедуру, сделали Undo - процедура на экране восстановилась, но так и считается свёрнутой.</LI>
<LI>В свёрнутом виде процедура идентифицируется только по её названию, в связи с этим, если свернуть процедуру и изменить её название, то развернуть её потом не получится, т.к. это будет уже новая процедура. Если свернуть процедуру, удалить её, а потом завести такую же, она будет считаться свёрнутой, и при разворачивании восстановит текст старой. В связи с этим изменять свёрнутую процедуру/функцию не рекомендуется!</LI>
<LI>Поскольку непонятно, как сворачивать процедуры, записанные на одной строке или другими подобными способами, сворачиваются только "нормально" задекларированные процедуры и функции, т.е. такие, где слова "Процедура", "Функция", "КонецПроцедуры", "КонецФункции" записаны на отдельных строках.</LI>
<LI>Тексты свёрнутых методов исключаются из анализа скриптом Intellisense, т.к. их фактически нет.</LI>
<LI>Процедуры и функции сворачиваются не в одну строку, как в 8-ой версии 1С, а в две. Второй строкой добавляется КонецФункции/КонецПроцедуры, чтобы работал список методов модуля, codejump телепата, синтаксический контроль и т.д.</LI>
<LI>Плагин не даёт закрыть окно/конфигурацию/конфигуратор если открыты окна со свёрнутыми процедурами. Однако, всё же остаётся возможность потерять текст свёрнутых процедур, например, если свернуть процедуру, сохранить конфигурацию, развернуть процедуру и закрыть конфигурацию, отказавшись от сохранения.</LI>
</UL>

<p class="paragraph">
На всякий случай тексты процедур и функций при свёртке сохраняются в файлах в каталоге <b>КаталогИБ + "OColorer_Temp\" + "НазваниеДокумента_НазваниеМетода"</b>.
</p>

<p class="paragraph">
Скрипт OColorer.vbs содержит следующие полезные макросы (горячие клавиши для макросов задаются через меню "OpenConf" - "Макросы" - "Клавиатура..."):
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Рекомендуемая клавиша</TH><TH>Описание</TH></TR>

<TR>
<TD>CollapseAll</TD><TD>Ctrl+Shift+NumMinus</TD>
<TD>Cвернуть все процедуры/функции модуля.</TD>
</TR>

<TR>
<TD>ExpandAll</TD><TD>Ctrl+Shift+NumPlus</TD>
<TD>Развернуть все процедуры/функции модуля.</TD>
</TR>

<TR>
<TD>JumpToPairBracket</TD><TD>Ctrl+ъ</TD>
<TD>Перейти к "парной скобке". Примечание: эта функция работает несколько иначе, чем стандартные клавиши Конфигуратора Ctrl+[ и Ctrl+] (просто попробуйте, чтобы увидеть различия).</TD>
</TR>

<TR>
<TD>SelectPairBlock</TD><TD>Ctrl+Shift+ъ</TD>
<TD>Выделить текст между "парными скобками". Примечание: эта функция работает несколько иначе, чем стандартные клавиши Конфигуратора Ctrl+Shift+[ и Ctrl+Shift+] (просто попробуйте, чтобы увидеть различия).</TD>
</TR>

<TR>
<TD>SelectInnerBlock</TD><TD>Ctrl+Alt+ъ</TD>
<TD>Выделить текст между "парными скобками", исключая сами скобки.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Для открывающей и закрывающей "скобки" можно настроить собственный вариант подсветки. Настраиваются цвет шрифта, цвет фона, цвет рамки, и цвет подчеркивания - см. комментарии в тексте скрипта OColorer.vbs.
</p>

<p class="paragraph">
Можно настроить подсветку "скобок" в двух вариантах: только когда курсор на скобке, или из любого места внутри блока - см. комментарии в тексте скрипта OColorer.vbs.
</p>

<p class="paragraph">
Замеченные неприятности:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>К сожалению, плагин стабильно работает не на всех системах, иногда наблюдается неверная отрисовка закладок и границ процедур на gutter'е, а также неверная отрисовка "парных скобок" в коде (и то, и другое - значительно выше, чем надо).</LI>
<LI>В конце модулей при свёртке процедур возможно некоторое "помешательство" в коде, которое восстанавливается после прокрутки мышью.</LI>
<LI>Может быть некорректной прорисовка скобок при горизонтальном скроллинге текста (мышью за нижнюю полосу прокрутки).</LI>
</UL>

<p class="paragraph">
Вы можете скачать плагин <a href="OColorer_0901.zip">здесь</a> (версия 0.9.0.1 от 26.02.2007г., 318 295 байт).
</p>

<h2 style="text-indent:1.3em">Версия 0.9.1.1</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0911.zip">здесь</a> (версия 0.9.1.1 от 07.12.2007г., 173 850 байт).
</p>

<p class="paragraph">
Плагин <b>стабилизировался</b>, исправлены многие ошибки.
</p>

<p class="paragraph">
Установка:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Скопируйте <b>SciColorer.dll</b> и <b>SciLexer.dll</b> в каталог плагинов \Bin\Config\, скрипт <b>SciColorer.vbs</b> - в каталог скриптов \Bin\Config\Scripts.</LI>
<LI>Для корректной работы подсказок необходима специальная новая версия плагина "Телепат" 2.0.0.0t, которую можно взять <a href="OpenConf.html">здесь</a>.</LI>
</UL>

<p class="paragraph">
Скрипт SciColorer.vbs содержит следующие полезные макросы (горячие клавиши для макросов задаются через меню "OpenConf" - "Макросы" - "Клавиатура..."):
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Рекомендуемая клавиша</TH><TH>Описание</TH></TR>

<TR>
<TD>CollapseAll</TD>
<TD>Ctrl + Shift + Num -</TD>
<TD>Cвернуть все процедуры/функции модуля.</TD>
</TR>

<TR>
<TD>ExpandAll</TD>
<TD>Ctrl + Shift + Num +</TD>
<TD>Развернуть все процедуры/функции модуля.</TD>
</TR>

<TR>
<TD>ToggleCurrent</TD>
<TD>Ctrl + Num *</TD>
<TD>Свернуть/развернуть текущий блок.</TD>
</TR>

<TR>
<TD>ToggleCurrentWithSubLevels</TD>
<TD>Ctrl + Shift + Num *</TD>
<TD>Свернуть/развернуть текущий блок вместе с вложенными блоками.</TD>
</TR>

<TR>
<TD>ShowSettings</TD>
<TD>Вызовите этот макрос один раз "вручную" через Ctrl+M и установите флажок "интегрироваться в меню «Текст»". После этого диалог настроек будет всегда доступен через меню "Текст" - "Настройки...".</TD>
<TD>Вызов диалога настроек.</TD>
</TR>

<TR>
<TD>SelectCurrentBlock</TD>
<TD>Ctrl + Num 5</TD>
<TD>Выделить текущий блок.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Некоторые важнейшие приёмы работы:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Свернуть / развернуть текущий блок вместе с вложенными блоками - Ctrl + Click на маркере свёртки кода.</LI>
<LI>Комментировать / раскомментировать блок - Shift + Click / Ctrl + Shift + Click на маркере свёртки кода.</LI>
<LI>Тщательно изучите диалог настроек (там очень много возможностей) и установите нужные вам опции.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 0.9.1.3</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0913.zip">здесь</a> (версия 0.9.1.3 от 26.12.2007г., 175 909 байт).
</p>

<p class="paragraph">
Начиная с версии 0.9.1.2, когда курсор находится в начале свернутого блока:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Если блок свёрнут и нажата клавиша {RIGHT}, блок разворачивается.</LI>
<LI>Если блок развёрнут и нажата клавиша {LEFT}, блок сворачивается.</LI>
</UL>

<p class="paragraph">
Также сделан ряд небольших изменений и исправлений ошибок. Подробности - см. в файле <b>history.txt</b> в архиве.
</p>

<h2 style="text-indent:1.3em">Версия 0.9.1.6</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0916.zip">здесь</a> (версия 0.9.1.6 от 27.01.2008г., 182 704 байт).
</p>

<p class="paragraph">
Сделан ряд доработок, расширяющих функционал. В частности, добавлен режим "только чтение" и подсветка модифицированных строк. Подробности - см. в файле <b>history.txt</b> в архиве.
</p>

<h2 style="text-indent:1.3em">Версия 0.9.1.7</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0917.zip">здесь</a> (версия 0.9.1.7 от 05.03.2008г., 184 192 байт).
</p>

<p class="paragraph">
Сделан ряд доработок, расширяющих функционал, исправлены некоторые ошибки. Подробности - см. в файле <b>history.txt</b> в архиве.
</p>

<h2 style="text-indent:1.3em">Версия 0.9.1.8</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0918.zip">здесь</a> (версия 0.9.1.8 от 20.04.2008г., 185 730 байт).
</p>

<p class="paragraph">
Сделан ряд доработок, расширяющих функционал, исправлены некоторые ошибки. Подробности - см. в файле <b>history.txt</b> в архиве.
</p>

<h2 style="text-indent:1.3em">Версия 0.9.2.0</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0920.zip">здесь</a> (версия 0.9.2.0 от 27.05.2008г., 190 487 байт).
</p>

<p class="paragraph">
Сделан ряд доработок, расширяющих функционал, исправлены некоторые ошибки. Полный перечень - см. в файле <b>history.txt</b> в архиве. Важно:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Добавлена возможность устанавливать цвет фона для строк (c версии 0.9.1.9).</LI>
<LI>Добавлен функционал "гиперссылок". При наведении мыши на идентификаторы модуля при нажатом Ctrl они подчеркиваются и выделяются цветом (добавлен стиль "гиперссылка"), а при клике генерируется "Событие". Обрабатывается это событие следующим образом: в OpenConf есть возможность настроить 16 доп. кнопок для вызова произвольных макросов. В меню "OpenConf" - "Макросы" - "Настройка комманд" добавляем новую команду, сопоставляем макрос (в прилагаемом SciColorer.vbs есть макрос ColorerOnHotSpotClick, который вызывает "кодеджамп" плагина "Телепат"). В настройках SciColorer указываем порядковый номер вышесозданной команды (от 1 до 16).</LI>
<LI>Скрипт SciColorer.vbs дополнен макросами для всех команд плагина.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 0.9.2.1</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0921.zip">здесь</a> (версия 0.9.2.1 от 05.08.2008г., 321 490 байт).
</p>

<p class="paragraph">
Устранены некоторые проблемы совместимости с элементом управления <a href="http://www.1cpp.ru/forum/YaBB.pl?num=1217410246">1sci</a>. Новых функций не добавлено.
</p>

<h2 style="text-indent:1.3em">Версия 0.9.2.2</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_0922.zip">здесь</a> (версия 0.9.2.2 от 16.09.2008г., 324 030 байт).
</p>

<p class="paragraph">
Сделан ряд доработок, расширяющих функционал, исправлены некоторые ошибки. Подробности - см. в файле <b>history.txt</b> в архиве.
</p>

<h2 style="text-indent:1.3em">Версия 1.0.0.2</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1002.zip">здесь</a> (версия 1.0.0.2 от 31.10.2008г., 331 379 байт).
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Плагин преобразован в OLE-плагин с возможностью программного управления и генерации событий.</LI>
<LI>Добавлено событие OnLineNumbersContextMenu - вызывается при контекстном меню на отступе с номерами строк.</LI>
<LI>Добавлен метод ReloadSettings - перечитать настройки из ini файла.</LI>
<LI>Добавлены три списка дополнительных ключевых слов и три стиля отображения к ним.</LI>
</UL>

<p class="paragraph">
При обновлении необходимо также обновить и скрипт, идущий в комплекте.
</p>

<h2 style="text-indent:1.3em">Версия 1.0.0.4</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1004.zip">здесь</a> (версия 1.0.0.4 от 30.12.2008г., 333 275 байт).
</p>

<p class="paragraph">
По сравнению с версией 1.0.0.2:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Добавлена поддержка перетаскивания из синтакс-помощника.</LI>
<LI>Добавлена поддержка возможности штатного редактора перетаскивать текст правой кнопкой мыши с вызовом контекстного меню "Переместить - Копировать - Отмена".</LI>
<LI>Добавлена возможность "бросать" на редактор любые файлы, в этом случае в текст вставляется путь к этому файлу.</LI>
<LI>При наведении курсора мыши на вертикальные пунктирные линии, отображающие границы выравнивания текста табуляцией, появляется всплывающая подсказка с текстом первой и последней строки блока.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 1.0.0.7</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1007.zip">здесь</a> (версия 1.0.0.7 от 19.03.2009г., 336 262 байт).
</p>

<p class="paragraph">
По сравнению с версией 1.0.0.4:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Добавлена функция подсветки выделенного слова во всём тексте (новый стиль "Выделенное слово").</LI>
<LI>Сделана подсветка не только слов, но и любого выделенного текста в пределах одной строки.</LI>
<LI>Исправлен тройной клик правой кнопкой мыши, выделявший всю строку.</LI>
<LI>Подсветка глобальных методов и переменных (стиль "Глобальные методы").</LI>
<LI>Подсветка реквизитов справочников и документов, модуль которых редактируется в даный момент. Для отчетов и обработок подсвечиваются идентификаторы элементов формы (стиль "Реквизиты объекта МД"). Если модуль объекта загружается с помощью директивы "ЗагрузитьИзФайла", то в первой строке текстового файла с модулем возможна прямая типизация данного объекта в виде //:Документ.&lt;ВидДокумента&gt; или //:Справочник.&lt;ВидСправочника&gt;</LI>
<LI>Возможность отключить в настройках функцию подсветки выделенного слова во всем тексте.</LI>
<LI>Клавиша end заработала по принципу home, т.е переходит в конец строки/к первому значимому символу с конца строки.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 1.0.0.9</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1009.zip">здесь</a> (версия 1.0.0.9 от 02.04.2009г., 336 520 байт).
</p>

<p class="paragraph">
По сравнению с версией 1.0.0.7:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Добавлено распознавание глобальных переменных в виде:
<span style="color:navy; font-weight:bold">
<pre>
Перем п1 Экспорт , п2 //:ТаблицаЗначений
    Экспорт;
</pre>
</span>
</LI>
<LI>Фон текущей строки теперь не перекрывает фон других стилей.</LI>
<LI>Исправлены некоторые ошибки.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 1.0.1.0</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1010.zip">здесь</a> (версия 1.0.1.0 от 10.05.2009г., 337 480 байт).
</p>

<p class="paragraph">
По сравнению с версией 1.0.0.9:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>В диалоге выбора шрифта добавлено поле для выбора набора символов.</LI>
<LI>Добавлена возможность отображения непечатаемых символов (флажок в настройках и новая команда в скрипте).</LI>
<LI>Исправлены некоторые ошибки.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 1.0.1.1</h2>

<p class="paragraph">
Вы можете скачать плагин <a href="SciColorer_1011.zip">здесь</a> (версия 1.0.1.1 от 07.06.2009г., 337 967 байт).
</p>

<p class="paragraph">
По сравнению с версией 1.0.1.0:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Добавлен новый стиль подсветки "Фон заголовков методов", для возможности установки фона строки с названием процедуры.</LI>
<LI>Если в начале блока комментария первым символом стоит "\", то при открытии модуля такой блок не будет свёрнут.</LI>
</UL>

<p style="text-align:right">
<small>Людоговский Александр</small>
</p>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>

<p><small>&copy; 2007 <A HREF='http://www.script-coding.com/'>http://www.script-coding.com</A> При любом использовании материалов сайта обязательна <b>ссылка</b> на него как на источник информации, а также сохранение <b>целостности</b> и <b>авторства</b> материалов.</small>



</body></html>
