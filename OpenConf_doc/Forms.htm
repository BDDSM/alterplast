<html><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>Forms</title>
<meta name="keywords" content="Forms скрипты OpenConf 1С:Предприятие">
<meta name="description" content="Скрипты для платформы OpenConf: работа с формами">
<style type="text/css">
	.paragraph {text-align:justify; text-indent:2em; margin-top:0; margin-bottom:0}
</style>
</head>
<body bgcolor=#E0E0E0>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>
<p><a href="http://forum.script-coding.com">ФОРУМ (здесь можно обсудить эту статью, а также любые
проблемы программирования на различных макроязыках и в скриптовых средах)</a></p>

<h1>Скрипты для платформы OpenConf: работа с формами</h1>

<h2 style="text-indent:1.3em">Назначение и установка скриптов</h2>

<p class="paragraph">
Скрипты для платформы OpenConf, о которых пойдёт речь в этой статье, предназначены для повышения удобства и автоматизации работы с формами конфигурации или внешних обработок 1С:Предприятия. Данные скрипты требуют наличия работающего OpenConf. Получить информацию об OpenConf (в том числе и о том, где его можно скачать вместе со скриптами, о которых пойдёт речь в этой статье) вы можете в статье "<a href="OpenConf.html">Проект OpenConf (Открытый Конфигуратор)</a>" на этом сайте. Скрипты для платформы OpenConf распространяются свободно.
</p>

<p class="paragraph">
Установка скриптов сводится к следующему:
</p>

<OL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>Установите OpenConf, если он ещё не установлен.</LI>

<LI>Установите MS XML Parser, если он не установлен на вашем компьютере.</LI>

<LI>Скопируйте файл <b>CommonServices.wsc</b> в любой каталог на жёстком диске, например
<br><br>
<span style="color:navy; font-weight:bold;">
C:\Program Files\1Cv77\BIN\config\system\
</span>
<br><br>
Этот файл не должен лежать непосредственно в подкаталоге "config" каталога исполняемых файлов 1С:Предприятия, так как все dll-файлы из этой папки OpenConf считает плагинами и пытается их загрузить в момент запуска Конфигуратора (а этот файл плагином для OpenConf не является). Зарегистрируйте в системе эту библиотеку с помощью regsvr32.exe, если это ещё не сделано. Командная строка регистрации библиотеки может выглядеть, например, так:
<br><br>
<span style="color:navy; font-weight:bold;">
regsvr32.exe "C:\Program Files\1Cv77\BIN\config\system\CommonServices.wsc"
</span>
<br><br>
</LI>

<LI>Скопируйте файлы
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Редактор форм.js</LI>
<LI>Шаблоны форм.js</LI>
<LI>ExpandForm.vbs</LI>
<LI>Создать кнопку на форме.vbs</LI>
<LI>ПроверитьФункцииВФормулах.vbs</LI>
</UL>
в подкаталог "config\scripts\Forms\" каталога исполняемых файлов 1С:Предприятия, если этих файлов там ещё нет. Полный путь к этому каталогу может выглядеть, например, так:
<br><br>
<span style="color:navy; font-weight:bold;">
C:\Program Files\1Cv77\BIN\config\scripts\Forms\
</span>
<br><br>
Примечание: в принципе, папку "Forms" можно и не создавать, положив скрипты прямо в "config\scripts\". Однако, кроме этих скриптов, для OpenConf существуют и другие скрипты. Если впоследствии вы захотите установить их, хорошо организованная структура папок вам пригодится.
</LI>

<LI>Скопируйте файл <b>FormEditor.html</b> в подкаталог "config\html\" каталога исполняемых файлов 1С:Предприятия, если этого файла там ещё нет. Полный путь к этому каталогу может выглядеть, например, так:
<br><br>
<span style="color:navy; font-weight:bold;">
C:\Program Files\1Cv77\BIN\config\html\
</span>
<br><br>
</LI>

<LI>Перезапустите Конфигуратор, если он был запущен.</LI>

</OL>

<h2 style="text-indent:1.3em">Использование</h2>

<p class="paragraph">
Установленные скрипты содержат макросы (состав макросов вы можете изучить в дереве на вкладке OpenConf окна конфигурации), каждому из которых вы можете назначить сочетание клавиш через меню "OpenConf" - "Макросы" - "Клавиатура...". Вы можете запустить любой макрос и вручную, находясь в любом режиме работы, нажав Ctrl+M и выбрав нужный макрос в специальном диалоговом окне.
</p>

<hr>

<p class="paragraph">
Скрипт <b>Шаблоны форм.js</b> позволяет быстро создавать формы по ранее созданным шаблонам. Полезные макросы:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>createFormTemplate</TD>
<TD>Создаёт локальный или глобальный шаблон открытой в данный момент формы.</TD>
</TR>

<TR>
<TD>createControlsTemplate</TD>
<TD>Создаёт локальный или глобальный шаблон, включающий выделенные элементы управления открытой в данный момент формы.</TD>
</TR>

<TR>
<TD>loadForm</TD>
<TD>Загружает выбранный локальный или глобальный шаблон в открытую в данный момент форму.</TD>
</TR>

<TR>
<TD>loadControls</TD>
<TD>Загружает выбранный локальный или глобальный шаблон, состоящий из группы элементов управления, в открытую в данный момент форму.</TD>
</TR>

<TR>
<TD>deleteFormTemplate</TD>
<TD>Удаляет выбранный локальный или глобальный шаблон из списка (и физически).</TD>
</TR>

<TR>
<TD>deleteControlsTemplate</TD>
<TD>Удаляет выбранный локальный или глобальный шаблон, состоящий из группы элементов управления, из списка (и физически).</TD>
</TR>

<TR>
<TD>replaceString</TD>
<TD>Заменяет строки / части строк в идентификаторах, заголовках или формулах элементов управления открытой в данный момент формы с помощью регулярных выражений.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Глобальные шаблоны хранятся в файле <b>Шаблоны форм.xml</b>, расположенном в подкаталоге "config" каталога исполняемых файлов 1С:Предприятия (файл создаётся автоматически). Глобальные шаблоны будут доступны для выбора с помощью макросов <i>loadForm</i> и <i>loadControls</i> в любой информационной базе 1С:Предприятия. Локальные шаблоны хранятся в файле <b>Шаблоны форм.xml</b>, расположенном в каталоге той информационной базы 1С:Предприятия, в которой они создавались (файл создаётся автоматически) и доступны для выбора только в этой базе. Если форма содержит элементы управления, связанные со специфическими реквизитами объектов, характерными для конкретной конфигурации, есть смысл сохранять шаблон на основе этой формы как локальный.
</p>

<p class="paragraph">
В шаблоне формы хранится поток формы и модуль. В момент загрузки шаблона (макрос <i>loadForm</i>) содержимое самой формы и её модуля полностью замещается. В момент загрузки шаблона элементов управления (макрос <i>loadControls</i>) содержимое самой формы дополняется, а её модуль остаётся без изменений (впрочем, можно добавить вручную текст модуля в атрибут "Модуль" в файле <i>Шаблоны форм.xml</i>, тогда при загрузке шаблона элементов управления текст атрибута допишется в конец текущего модуля).
</p>

<p class="paragraph">
Макрос <i>replaceString</i> позволяет быстро модифицировать идентификаторы, заголовки или формулы элементов управления открытой в данный момент формы с помощью регулярных выражений (задаётся регулярное выражение для поиска и регулярное выражение для замены). В простейшем случае макрос может работать как замена заданной подстроки во всех элементах управления формы.
</p>

<hr>

<p class="paragraph">
Скрипт <b>Редактор форм.js</b> служит для удобства редактирования больших <i>многострочных частей форм документов</i>, <i>многострочных частей форм списков справочников</i> и <i>многострочных частей форм журналов</i>. Например, можно видеть все формулы колонок табличной части в едином списке, задавать ширину колонки указанием числа и т.д. Единственный макрос <i>openEditor</i> открывает окно редактора (перед этим откройте форму). Редактор позволяет добавлять/удалять/вставлять колонки в выбранную позицию, менять их порядок, изменять Идентификатор, Заголовок, Формулу, Описание, Подсказку, Ширину, Положение и Видимость колонки.
</p>

<p class="paragraph">
Верхний ряд кнопок в окне редактора работает со списком колонок и позволяет добавлять/удалять/вставлять колонки в выбранную позицию и менять их порядок. Навигация по списку колонок осуществляется клавишами <b>Вверх</b>, <b>Вниз</b>, <b>Home</b>, <b>End</b>. В списке колонок также можно пользоваться клавишами <b>Insert</b> (добавить колонку), <b>Ctrl+Insert</b> (вставить колонку), <b>Delete</b> (удалить колонку), <b>Ctrl+Home, Ctrl+End, Ctrl+Вверх, Ctrl+Вниз</b> (перемещение колонок).
</p>

<p class="paragraph">
Элементы управления редактора, расположенные под списком колонок, позволяют работать с содержимым текущей строки списка (которая соответствует конкретной колонке табличной части на форме). Если произведены какие-либо изменения, перед сменой позиции (переходу к другой строке списка) следует нажать кнопку "Применить" (или клавишу <b>Enter</b>). Сочетание клавиш <b>Ctrl+Enter</b> применяет изменения и закрывает редактор.
</p>

<p class="paragraph">
Клавиша <b>Escape</b> закрывает HTML-окно редактора.
</p>

<hr>

<p class="paragraph">
Скрипт <b>ExpandForm.vbs</b> служит для просмотра всех элементов управления формы и их свойств в развернутом виде (в одной таблице). Может быть удобен, например, для быстрого поиска и анализа заданных формул элементов диалога и других параметров. Единственный макрос <i>ShowExpandForm</i> открывает окно просмотра (форма должна быть предварительно открыта).
</p>

<hr>

<p class="paragraph">
Скрипт <b>Создать кнопку на форме.vbs</b> позволит быстро создать специальную "отладочную" кнопку на форме внешнего отчёта (макрос <i>CreateButtonReset</i>). Если у вас открыто Предприятие и Конфигуратор, и вы отлаживаете внешний отчет (обработку), такая кнопка позволит быстро "перезагрузить" внешний отчёт в Предприятии, если он был только что исправлен в Конфигураторе (нажатие на эту кнопку в Предприятии будет равносильно закрытию отчёта и его повторному открытию).
</p>

<hr>

<p class="paragraph">
Скрипт <b>ПроверитьФункцииВФормулах.vbs</b> предназначен для профилактических целей: единственный макрос <i>CheckControlFunctionsExistens</i> проверяет наличие функций, задействованных в элементах управления формы. Функции разыскиваются в текущем и глобальном модулях. Если ничего не найдено, то выдаётся сообщение вида <i>ИмяСлоя - Заголовок - Идентификатор - ИмяФункции</i>.
</p>

<p style="text-align:right">
<small>Людоговский Александр</small>
</p>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>

<p><small>&copy; 2007 <A HREF='http://www.script-coding.com/'>http://www.script-coding.com</A> При любом использовании материалов сайта обязательна <b>ссылка</b> на него как на источник информации, а также сохранение <b>целостности</b> и <b>авторства</b> материалов.</small>



</body></html>