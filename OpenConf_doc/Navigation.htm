<html><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>Navigation</title>
<meta name="keywords" content="Navigation скрипты OpenConf 1С:Предприятие">
<meta name="description" content="Скрипты для платформы OpenConf: навигация по коду">
<style type="text/css">
	.paragraph {text-align:justify; text-indent:2em; margin-top:0; margin-bottom:0}
</style>
</head>
<body bgcolor=#E0E0E0>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>
<p><a href="http://forum.script-coding.com">ФОРУМ (здесь можно обсудить эту статью, а также любые
проблемы программирования на различных макроязыках и в скриптовых средах)</a></p>

<h1>Скрипты для платформы OpenConf: навигация по коду</h1>

<h2 style="text-indent:1.3em">Назначение и установка скриптов</h2>

<p class="paragraph">
Скрипты для платформы OpenConf, о которых пойдёт речь в этой статье, предназначены для повышения удобства навигации
по коду конфигурации или внешних обработок 1С:Предприятия. Данные скрипты требуют наличия работающего OpenConf.
Получить информацию об OpenConf (в том числе и о том, где его можно скачать вместе со скриптами, о которых пойдёт
речь в этой статье) вы можете в статье "<a href="OpenConf.html">Проект OpenConf (Открытый Конфигуратор)</a>" на
этом сайте. Скрипты для платформы OpenConf распространяются свободно.
</p>

<p class="paragraph">
Установка скриптов сводится к следующему:
</p>

<OL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>Установите OpenConf, если он ещё не установлен.</LI>

<LI>Скопируйте файлы
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>CommonServices.wsc</LI>
<LI>Collections.wsc</LI>
<LI>SyntaxAnalysis.wsc</LI>
<LI>svcsvc.dll</LI>
<LI>ArtWin.dll</LI>
<LI>dynwrap.dll</LI>
</UL>
в любой каталог на жёстком диске, например
<br><br>
<span style="color:navy; font-weight:bold;">
C:\Program Files\1Cv77\BIN\config\system\
</span>
<br><br>
Эти файлы не должны лежать непосредственно в подкаталоге "config" каталога исполняемых файлов 1С:Предприятия, так
как все dll-файлы из этой папки OpenConf считает плагинами и пытается их загрузить в момент запуска Конфигуратора
(а эти файлы плагинами для OpenConf не являются). Зарегистрируйте в системе каждую из вышеуказанных библиотек с
помощью regsvr32.exe, если это ещё не сделано. Командная строка регистрации библиотеки может выглядеть, например,
так:
<br><br>
<span style="color:navy; font-weight:bold;">
regsvr32.exe "C:\Program Files\1Cv77\BIN\config\system\CommonServices.wsc"
</span>
<br><br>
</LI>

<LI>Скопируйте файлы
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Переходы по модулю.vbs</LI>
<LI>ScriptMethodList.vbs</LI>
<LI>navigator.js</LI>
<LI>Навигация.vbs</LI>
<LI>NavigationTools.vbs</LI>
<LI>Открыть файл из директивы ЗагрузитьИзФайла.vbs</LI>
<LI>jumper.vbs</LI>
<LI>FindText.vbs</LI>
<LI>Выбрать из списка.vbs</LI>
</UL>
в подкаталог "config\scripts\Navigation\" каталога исполняемых файлов 1С:Предприятия, если этих файлов там ещё нет.
Полный путь к этому каталогу может выглядеть, например, так:
<br><br>
<span style="color:navy; font-weight:bold;">
C:\Program Files\1Cv77\BIN\config\scripts\Navigation\
</span>
<br><br>
Примечание: в принципе, папку "Navigation" можно и не создавать, положив скрипты прямо в "config\scripts\". Однако,
кроме этих скриптов, для OpenConf существуют и другие скрипты. Если впоследствии вы захотите установить их, хорошо
организованная структура папок вам пригодится.
</LI>

<LI>Перезапустите Конфигуратор, если он был запущен.</LI>

</OL>

<h2 style="text-indent:1.3em">Использование</h2>

<p class="paragraph">
Установленные скрипты содержат макросы (состав макросов вы можете изучить в дереве на вкладке OpenConf окна
конфигурации), каждому из которых вы можете назначить сочетание клавиш через меню "OpenConf" - "Макросы" -
"Клавиатура...". Перед установкой сочетаний клавиш вы можете запустить любой макрос вручную, находясь в любом режиме
работы, нажав Ctrl+M и выбрав нужный макрос в специальном диалоговом окне.
</p>

<p class="paragraph">
Скрипт <b>Переходы по модулю.vbs</b> содержит следующие полезные макросы:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>GotoBeginOfMethod</TD>
<TD>Позволяет быстро перейти к началу текущей процедуры/функции. Текущее положение курсора при этом запоминается,
и к нему можно будет вернуться с помощью вызова макроса ReturnToSavedPosition.</TD>
</TR>

<TR>
<TD>GotoEndOfMethod</TD>
<TD>Позволяет быстро перейти к завершению текущей процедуры/функции. Текущее положение курсора при этом запоминается,
и к нему можно будет вернуться с помощью вызова макроса ReturnToSavedPosition.</TD>
</TR>

<TR>
<TD>ReturnToSavedPosition</TD>
<TD>Позволяет быстро вернуться на позицию курсора, которую он занимал перед последним прыжком, сделанным с помощью
GotoBeginOfMethod или GotoEndOfMethod.</TD>
</TR>

<TR>
<TD>SelectProcedure</TD>
<TD>Позволяет быстро выделить весь текст текущей процедуры/функции, чтобы например, затем быстро скопировать его в
буфер обмена или удалить.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Скрипт <b>ScriptMethodList.vbs</b> содержит полезный макрос "ShowMethodsList". В ветви дерева "Скрипты" вкладки
"OpenConf" в окне Конфигурации каждый скрипт представлен одним элементом. Двойной щелчок мыши, либо нажатие ENTER на
самом элементе скрипта открывает скрипт для редактирования в текстовом редакторе 1С:Предприятия. Если вы находитесь
в таком окне скрипта (vbs, js), макрос "ShowMethodsList" показывает список методов этого скрипта (для быстрого
перехода к выбранному методу), а иначе просто показывает окно "Методы модуля" от OpenConf. Этому макросу удобно
назначить сочетание клавиш Ctrl+1, сделав таким образом команду вызова списка методов универсальной - она будет
правильно работать как в текстовом окне модуля, так и в текстовом окне скрипта. Это может оказаться удобным для
просмотра или разработки скриптов OpenConf в текстовом редакторе 1С:Предприятия.
</p>

<p class="paragraph"><small>
Примечание: иногда при работе со скриптами в текстовом редакторе 1С:Предприятия при наличии установленной
бета-версии плагина "Телепат" возможны "вылеты" Конфигуратора (как правило, на больших скриптах). Поэтому
используйте эту возможность осторожно.
</small></p>

<p class="paragraph">
Скрипт <b>navigator.js</b> предназначен для быстрого доступа к формам и модулям объектов метаданных конфигурации или
объектам файловой системы, задаваемых в тексте модуля полным или относительным путём. Например, имея в тексте модуля
подстроки типа "Справочник.Номенклатура" или "Журнал.Общий", вы можете мгновенно открыть любую из форм объекта в
визуальном редакторе форм или любой из модулей объекта, если курсор стоит в пределах такой подстроки. Имея в тексте
модуля подстроку, содержащую путь к файлу или папке, вы можете мгновенно открыть файл ассоциированной программой или
папку в проводнике (в качестве базы для разрешения относительного пути до абсолютного используется каталог
информационной базы). Работа осуществляется с помощью двух макросов: <b>ОткрытьМодульДляОбъектаПодКурсором</b> и
<b>ОткрытьФормуДляОбъектаПодКурсором</b>, смысл которых ясен из идентификаторов. Если строка содержит путь файловой
системы, то оба макроса работают одинаково, за исключением случая, когда внешний файл - это отчёт или обработка.
Если открытие не срабатывает (например, из-за пробелов в пути), попробуйте предварительно выделить подстроку. Если
вариантов открытия может быть несколько, выдаётся специальный диалог выбора. Макросам удобно назначить горячие
клавиши:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>ОткрытьМодульДляОбъектаПодКурсором - например, Ctrl+Shift+M.</LI>
<LI>ОткрытьФормуДляОбъектаПодКурсором - например, Ctrl+Shift+F.</LI>
</UL>

<p class="paragraph">
Если установлен плагин "Телепат", то в подменю "Шаблоны" контекстного меню редактора текстов 1С:Предприятия будут
добавлены два пункта: "Открыть форму..." и "Открыть модуль...", соответствующие описанным выше макросам.
</p>

<p class="paragraph">
Скрипт <b>Навигация.vbs</b> предназначен в основном для похожих целей, что и <b>navigator.js</b>, но работает
несколько в другом стиле + имеет дополнительные возможности. Макросы скрипта:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>GoToObject</TD>
<TD>Выполняет переход к объекту, его модулям или месту инициализации переменной, или открывает файл (используя текст
под курсором или элемент, который находится в фокусе). Поведение макроса достаточно подробно описано в комментариях
в начале самого скрипта (дублировать эту информацию здесь большого смысла нет). Может выдаваться список вариантов,
куда перейти. В частности, позволяет быстро перейти к процедуре модуля из формулы на кнопке или создать такую
процедуру, если её ещё нет, перейти к объекту в дереве метаданных из реквизита диалога (по типу реквизита диалога),
осуществлять прыжки внутри дерева метаданных (по типу объектов) и т.п. Поэксперементируйте с этим макросом в
различных ситуациях, назначив ему сочетание клавиш (например, Ctrl+Shift+O). Использует <b>NavigationTools.vbs</b>
(прочитайте комментарии в начале этого скрипта) и <b>Открыть файл из директивы ЗагрузитьИзФайла.vbs</b>.</TD>
</TR>

<TR><TD></TD><TD></TD></TR>

<TR>
<TD>SelectAndNavigateToClasses</TD>
<TD>Служит для получения списка всех установленных классов 1С++, выбора из списка и открытия файла с телом класса,
после чего показывается окно "Методы модуля" для быстрого перехода к нужному методу. Удобен для быстрой навигации
по классам 1С++ и их коду.</TD>
</TR>

<TR><TD></TD><TD></TD></TR>

<TR>
<TD>ToggleWorkbookPage</TD>
<TD>Переключение страниц Диалог/Модуль. Имеет смысл назначить клавишу F12, как в Delphi.</TD>
</TR>

<TR>
<TD>GoToDialogPage</TD>
<TD>Переключение на страницу Диалога.</TD>
</TR>

<TR>
<TD>GoToModulePage</TD>
<TD>Переключение на страницу Модуля.</TD>
</TR>

<TR>
<TD>GoToMXLPage</TD>
<TD>Переключение на страницу шаблона Таблицы. Если шаблонов несколько, то выдаётся список для выбора.</TD>
</TR>

<TR>
<TD>GoToPage</TD>
<TD>Переключение на страницу Диалога/Модуля/Таблицы. Выдаётся список всех страниц, и производится переход к
выбранной странице.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Скрипт <b>NavigationTools.vbs</b> используется макросом "GoToObject" скрипта "Навигация.vbs", а также имеет
полезные макросы:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>ActivateFindEdit</TD>
<TD>Устанавливает фокус ввода в поле поиска на панели инструментов "Стандартная" и вставляет туда текст из буфера обмена (можно назначить ему сочетание клавиш Ctrl+F).</TD>
</TR>

<TR>
<TD>SelectMetadataAndGotoObj</TD>
<TD>Осуществляет быстрый переход в дерево метаданных из любого режима работы (выдаётся список метаданных для выбора).
В списке для выбора возможна мгновенная фильтрация по вхождению нескольких подстрок. Можно назначить макросу
сочетание клавиш Ctrl+Shift+M.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Скрипт <b>Открыть файл из директивы ЗагрузитьИзФайла.vbs</b> используется макросом "GoToObject" скрипта
"Навигация.vbs".
</p>

<p class="paragraph">
Скрипт <b>jumper.vbs</b> реализует функционал для быстрого перемещения по тексту модуля по управляющим конструкциям
"Если", "Пока", "Процедура" и т.п. Функционал реализован в трёх стилях (различающихся "размахом" прыжка) в виде
трёх пар макросов для прыжков вверх и вниз. Выберите подходящий вам стиль и назначьте сочетания клавиш для прыжков
вверх и вниз (например, Ctrl+Shift+U и Ctrl+Shift+D). Прочитайте комментарии в начале скрипта.
</p>

<p class="paragraph">
Скрипт <b>FindText.vbs</b> реализует функционал поиска текста в текущем модуле с установкой закладок с помощью
регулярных выражений. Полезные макросы скрипта:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>FindWithAddBookmarks</TD>
<TD>При вызове макроса откроется окно поиска с двумя готовыми шаблонами: для поиска только в комментариях и только
НЕ в комментариях. Для использования этих шаблонов замените текст в конце шаблона ("ВыражениеТолькоНеКомментариях"
или "ВыражениеТолькоВКомментариях") на свой текст и нажмите Enter. Вы получите список найденного с номерами строк,
из которого можно мгновенно перейти к любому найденному месту (обратите внимание, что размеры окна с этим списком
можно изменять). В модуле будут автоматически установлены закладки на каждом найденном фрагменте (вы можете
просмотреть их все, перемещаясь по модулю с помощью клавиши F2). При следующем вызове макроса список предлагаемых
шаблонов поиска будет пополнен вашим шаблоном.</TD>
</TR>

<TR>
<TD>FindWithoutAddBookmarks</TD>
<TD>То же, что и FindWithAddBookmarks, но закладки в модуле не устанавливаются.</TD>
</TR>

</TABLE>
<br>

<p class="paragraph">
Макрос <b>SelectFromComboBox</b> скрипта <b>Выбрать из списка.vbs</b> позволяет осуществить быстрый выбор из выпадающего списка, в котором находится фокус ввода. Выбор производится с помощью удобного фильтрующегося списка (можно фильтровать по вхождению нескольких подстрок). Это удобно при выборе типа реквизита метаданного в диалоге "Свойства Реквизита" или при выборе типа реквизита диалога в окне "Свойства", когда фокус ввода находится в	выпадающем списке. Скрипт также работает и в "обычных" списках, например при поиске в синтаксис-помощнике. Если "повесить" макрос на горячую клавишу (например, Alt+F7), то он отработает и в модальных окнах.
</p>

<p style="text-align:right">
<small>Людоговский Александр</small>
</p>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>

<p><small>&copy; 2007 <A HREF='http://www.script-coding.com/'>http://www.script-coding.com</A> При любом использовании материалов сайта обязательна <b>ссылка</b> на него как на источник информации, а также сохранение <b>целостности</b> и <b>авторства</b> материалов.</small>



</body></html>