<html><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>fdsubst</title>
<meta name="keywords" content="плагин fdsubst OpenConf 1С:Предприятие">
<meta name="description" content="Плагин fdsubst для платформы OpenConf">
<style type="text/css"> 
	.paragraph {text-align:justify; text-indent:2em; margin-top:0; margin-bottom:0}
</style>
</head>
<body bgcolor=#E0E0E0>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>
<p><a href="http://forum.script-coding.com">ФОРУМ (здесь можно обсудить эту статью, а также любые
проблемы программирования на различных макроязыках и в скриптовых средах)</a></p>

<h1>Плагин FdSubst для платформы OpenConf</h1>

<h2 style="text-indent:1.3em">Назначение и установка</h2>

<p class="paragraph">
Замена стандартных диалогов открытия/сохранения файла в Конфигураторе 1С:Предприятия. Плагин "превращает" все стандартные диалоги открытия/сохранения файлов 1С:Предприятия в диалоги в стиле Проводника, с удобной панелью слева, содержащей значки для быстрого перехода к различным папкам, и некоторыми другими возможностями, которых нет в стандартных диалогах.
</p>

<p class="paragraph">
Ник автора плагина: MetaEditor.
</p>

<p class="paragraph">
Возможности:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Семь кнопок для быстрого перехода на панели слева (пять кнопок, стандартных для Проводника, плюс две дополнительных кнопки сверху). Все семь кнопок подвергаются настройке.</LI>
<LI>Пути последних открытых/сохранённых файлов запоминаются в выпадающем списке "Имя файла".</LI>
<LI>Внизу диалога имеется строка состояния, отображающая полный путь текущей открытой папки.</LI>
<LI>В список фильтров диалога открытия файла добавлен пункт "Все файлы".</LI>
<LI>В верхней панели инструментов диалога добавлена настраиваемая кнопка "Избранное".</LI>
<LI>При удержании клавиши <i>Shift</i> в момент открытия диалога открывается диалог прежнего вида.</LI>
</UL>

<p class="paragraph">
Установка: скопируйте файл <b>fdsubst.dll</b> в подкаталог <b>\BIN\Config\</b> каталога установки 1С:Предприятия. Если 1С:Предприятие было запущено, перезапустите его.
</p>

<p class="paragraph">
Вы можете скачать плагин <a href="http://1c.proclub.ru/modules/mydownloads/personal.php?lid=5476&cid=1001">в Клубе Профессионалов 1С</a> или <a href="fdsubst_oc_plugin_2012.zip">здесь</a> (версия 2.0.1.2, 24 369 байт).
</p>

<h2 style="text-indent:1.3em">Настройка</h2>

<p class="paragraph">
Настройка двух дополнительных кнопок для быстрого перехода на панели слева: 
</p>

<span style="color:navy; font-weight:bold;">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\CustomPlaces\
</pre>
</span>

<p class="paragraph">
В вышеуказанной ветви реестра создайте два строковых параметра с именами <b>CustomPlace1</b> и <b>CustomPlace2</b> со значениями в формате <b>&lt;Заголовок кнопки&gt;#&lt;Путь к папке&gt;</b>, например, <b>Projects#D:\1C\Projects</b>. Если значения в реестре не заданы, то по умолчанию создаются кнопки "Каталог ИБ" и "Каталог 1С". В путях допускаются символы макроподстановки и переменные окружения, подробнее описанные ниже. После настройки потребуется перезапуск 1С:Предприятия.
</p>

<p class="paragraph">
Настройка пяти кнопок для быстрого перехода, стандартных для Проводника, будет касаться всех приложений и описана здесь: <a href="CommonDialogBox.html">Настройка стандартных диалоговых окон открытия и сохранения файла в Windows-программах</a>.
</p>

<p class="paragraph">
Настройка кнопки "Избранное" в верхней панели инструментов диалога:
</p>

<span style="color:navy; font-weight:bold;">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\MRUList\
</pre>
</span>

<p class="paragraph">
В вышеуказанной ветви реестра задайте список строковых параметров, где имя параметра - это наименование пункта выпадающего меню, а значение параметра - сопоставляемый ему путь к папке или файлу. В путях допускаются символы макроподстановки и переменные окружения, подробнее описанные ниже. После настройки потребуется перезапуск 1С:Предприятия или щелчок мышью по кнопке "Избранное" с удержанием <i>Shift</i>.
</p>

<p class="paragraph">
В названии параметра (пункта меню избранного) может быть указан символ "|" для группировки в подменю (только один уровень вложенности). Например, параметры <br>
<b>Каталог 1С|Intell</b><br>
<b>Каталог 1С|Каталог 1С</b><br>
<b>Каталог 1С|Скрипты</b><br>
будут сгруппированы в подменю "Каталог 1С".
</p>

<p class="paragraph">
Настройка путей к папкам в реестре: в строке пути могут быть указаны значения переменных окружения, например, <b>%windir%</b>, <b>%userprofile%</b>, <b>%programfiles%</b>, и т.п. Также в качестве "переменных окружения" можно указывать <b>%ibdir%</b> и <b>%bindir%</b> - каталог информационной базы и каталог программных файлов 1С:Предприятия соответственно. Кроме того, перед значениями переменных окружения допускаются символы "-", количество которых обозначает переход на нужное количество уровней вверх. Примеры возможных путей:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>%-userprofile%\All Users\Documents - общие документы.</LI>
<LI>%ibdir%\ExtForms - каталог внешних обработок текущей базы.</LI>
<LI>%-ibdir% - каталог с базами.</LI>
<LI>%bindir%\Config - папка OpenConf'а.</LI>
<LI>%temp% - каталог временных файлов.</LI>
<LI>%-windir% - системный диск.</LI>
</UL>

<p class="paragraph">
Предпросмотр картинок в диалоге выбора изображения, к сожалению, работать не будет (при вызове диалога открытия файла из библиотеки картинок конфигурации флажок "Просмотр" не произведёт эффекта). Однако, в Windows XP для этого случая возможно автоматическое переключение в режим "просмотр эскизов". Для этого в реестре необходимо создать нижеуказанный строковый параметр со значением 1:
</p>

<span style="color:navy; font-weight:bold;">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\fdsubst\Options\AutoThumbnailsView
</pre>
</span>

<h2 style="text-indent:1.3em">Версия 3.0.1.0</h2>

<p class="paragraph">
Вы можете скачать плагин на <a href="http://www.infostart.ru/projects/index.php?id=456&ref=1956">инфостарте</a> или <a href="fdsubst_oc_plugin_3010.zip">здесь</a> (версия 3.0.1.0 от 25.08.2006, 73 224 байт). Теперь к плагину прилагается внешняя компонента для 1С:Предприятия, а также отдельное независимое приложение, позволяющее заменить диалоги открытия/сохранения файлов в любых программах.
</p>

<br>

<p class="paragraph">
<u>Новое в плагине</u>:
</p>

<br>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Заработал просмотр картинок в диалоге выбора изображения.</LI>
<LI>Появился визуальный диалог настройки параметров (меню "Избранное"), что избавляет от необходимости ручной правки реестра.</LI>
</UL>

<p class="paragraph">
Диалог настройки параметров вызывается кнопкой избранного (пиктограмма звёздочки в верхней части справа в окне диалога выбора файла). Пункты меню "Добавить в список..." и "Настройка..." вызывают один и тот же диалог настроек, но в первом случае в диалоге автоматически предлагается добавить в избранное текущую папку.
</p>

<p class="paragraph">
Список "Меню избранного" в диалоге позволяет добавить, удалить и рассортировать дополнительные (пользовательские) пункты меню избранного, которые появятся выше пунктов "Добавить в список..." и "Настройка...". Список служит для управления параметрами ветки реестра HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\MRUList\ (см. выше описание предыдущей версии плагина). Для вставки разделителя в меню достаточно создать пункт меню с названием "-".
</p>

<p class="paragraph">
Группа "Дополнительные кнопки в PlacesBar" - "1С:Предприятие 7.7/8.x" в диалоге позволяет задать имена и пути к нужным папкам для двух дополнительных кнопок быстрого перехода на панели слева. Группа управляет параметрами ветки реестра HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\CustomPlaces\ (см. выше описание предыдущей версии плагина).
</p>

<p class="paragraph">
Флажок "увеличивать диалоги" в левом нижнем углу диалога настройки позволяет автоматически несколько увеличить размер диалога выбора файла при его последующих вызовах. Для вступления изменений в силу нужно перезапустить Конфигуратор.
</p>

<p class="paragraph">
Остальные элементы управления диалога настройки работают только для дополнительного независимого приложения, позволяющего заменить диалоги открытия/сохранения файлов в любых программах (об этом ниже).
</p>

<br>

<p class="paragraph">
<u>Внешняя компонента</u>:
</p>

<br>

<p class="paragraph">
Позволяет загрузить и использовать плагин в режиме предприятия. Реализует один метод:
</p>

<span style="color:navy; font-weight:bold">
<pre>
ЗагрузитьБиблиотеку(&lt;ИмяФайла&gt;)
LoadLibrary(&lt;FileName&gt;)
</pre>
</span>

<p class="paragraph">
Метод возвращает: 1 - если библиотека загружена, 0 - если не загружена.
</p>

<p class="paragraph">
Хотя внешняя компонента писалась непосредственно для плагина к конфигуратору fdsubst.dll, чтобы использовать его функционал  в режиме предприятия, её можно использовать и для произвольных DLL. Эта внешняя компонента просто реализует обертку над API функцией LoadLibrary, т.е. если найдется какая-нибудь DLL, не являющаяся ни COM-вервером, ни внешней компонентой для 1С:Предприятия, а являющаяся "обычной" DLL, которая делает что-то полезное при её загрузке (собственно, чем и является плагин FdSubst), то её можно будет загрузить таким способом.
</p>

<p class="paragraph">
Пример использования:
</p>

<span style="color:navy; font-weight:bold">
<pre>
Если ЗагрузитьВнешнююКомпоненту("SimpleDllLoader.dll") = 1 Тогда
    Загрузчик = СоздатьОбъект("AddIn.SimpleDllLoader");
    Если Загрузчик.ЗагрузитьБиблиотеку(КаталогПрограммы() + "fdsubst.dll") = 0 Тогда
        Сообщить("Библиотека fdsubst.dll не загружена");
    КонецЕсли;
КонецЕсли;
</pre>
</span>

<p class="paragraph">
Внешняя компонента предоставляет возможность закрыть доступ ко всем диалогам открытия/сохранения файла в режиме предприятия, а также вставки картинок и OLE-объектов в таблицы. Для этого необходимо создать в реестре по адресу
</p>

<span style="color:navy; font-weight:bold">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\Options
</pre>
</span>

<p class="paragraph">
строковый параметр  <b>BlockEnterpriseDialogs</b> со значением 1.
</p>

<p class="paragraph">
Кроме того, внешняя компонента исправляет баг диалога выбора файла (ФС.ВыбратьФайл), который обрезает имя выбранного файла до 63-х символов.
</p>

<br>

<p class="paragraph">
<u>Внешнее приложение</u>:
</p>

<br>

<p class="paragraph">
Позволяет заменить диалоги открытия/сохранения файлов в 1С:Предприятии 7.7 и 8.х (файловый вариант) без специальной загрузки в конфигуратор или предприятие, работает для всех запущенных программ 1С. Кроме того, при установке соответствующей опции позволяет заменить диалоги открытия/сохранения файлов в любых программах.
</p>

<p class="paragraph">
Программа запускается из любой папки. В папке с программой должен быть файл fdsubst.dll. При запуске в трее появится иконка программы.
</p>

<p class="paragraph">
Программа тестировалась с различными приложениями, работает стабильно. Однако, в случае конфликтов имеется возможность исключить указанные приложения из обработки. Для этого в диалоге настроек необходимо добавить нужные программы в список "Программы-исключения". Например, CorelDraw, Photo-Paint и некоторые другие программы с их "специфическими" диалогами могут конфликтовать с FdSubst.
</p>

<p class="paragraph">
Для настройки двух дополнительных кнопок быстрого перехода на панели слева (имён и путей к нужным папкам) используйте группу "Дополнительные кнопки в PlacesBar" - "Остальные программы" в диалоге настроек.
</p>

<p class="paragraph">
Контекстное меню иконки программы в трее позволяет вызвать диалог настроек, поместить программу в автозагрузку, установить опцию применения "Для всех программ", вызвать диалог "О программе", завершить работу программы. Двойной щелчок по иконке программы в трее вызывает диалог настроек программы.
</p>

<h2 style="text-indent:1.3em">Версия 3.0.1.1</h2>

<p class="paragraph">
Вы можете скачать плагин на <a href="http://www.infostart.ru/projects/index.php?id=456&ref=1956">инфостарте</a> или <a href="fdsubst_oc_plugin_3011.zip">здесь</a> (версия 3.0.1.1 от 30.08.2006, 73 425 байт).
</p>

<p class="paragraph">
Исправлены небольшие ошибки:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Для метода 1С ФС.ВыбратьФайл() было невозможно выбрать/сохранить в несуществующий файл.</LI>
<LI>При определенных условиях ФС.ВыбратьФайл() возвращал некорректное имя файла.</LI>
<LI>При определенных условиях падали открытые приложения MS Office 2000 и Конфигуратор 1С с установленным плагином oc2vba63.dll.</LI>
</UL>

<h2 style="text-indent:1.3em">Версия 3.0.1.3</h2>

<p class="paragraph">
Вы можете скачать плагин на <a href="http://www.infostart.ru/projects/index.php?id=456&ref=1956">инфостарте</a> или <a href="fdsubst_oc_plugin_3013.zip">здесь</a> (версия 3.0.1.3 от 20.09.2006, 74 464 байт).
</p>

<p class="paragraph">
Исправлены небольшие ошибки:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>При открытии группы файлов в режиме предприятия приложение в некоторых случаях закрывалось с ошибкой (исправлено в версии 3.0.1.2).</LI>
<LI>В Windows 2000 не запоминалось предыдущее положение диалога.</LI>
</UL>

<p class="paragraph">
Добавлен строковый параметр <b>BlockAllDialogs</b> в разделе реестра:
</p>

<span style="color:navy; font-weight:bold">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\Options
</pre>
</span>

<p class="paragraph">
Если этот параметр равен "1", программа блокирует в системе все файловые диалоги "открыть" и "сохранить". Это можно использовать, например, для настройки безопасности при работе в терминале. В этом случае можно запускать 1С и FDSubst, например, в стартовом скрипте:
</p>

<span style="color:navy; font-weight:bold">
<pre>
Set Shell = CreateObject("WScript.Shell")
' опция "Для всех программ"
Shell.RegWrite "HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\Options\ModifyAllDialogs", "1"
' запрет всех диалогов
Shell.RegWrite "HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\Options\BlockAllDialogs", "1"
Set Proc = Shell.Exec("FDSubst1C.exe")
Shell.Run "&lt;1C&gt;", 1, true
Proc.Terminate
'или Shell.Run "logoff"
</pre>
</span>

<p class="paragraph">
Добавлен строковый параметр <b>DisableExplorerFunction</b> в разделе реестра:
</p>

<span style="color:navy; font-weight:bold">
<pre>
HKEY_CURRENT_USER\Software\1C\1Cv7\7.7\OpenConf\Plugins\FDsubst\Options
</pre>
</span>

<p class="paragraph">
Если этот параметр равен "1", программа "отключает" в файловых диалогах контекстное меню в списке файлов, то есть через диалог нельзя скопировать, удалить, открыть другой файл, и т.д. Таким образом, в 1С остаётся возможность сохранять печатные формы отчетов, но при этом файловые операции будут недоступны. Параметры   BlockAllDialogs и BlockEnterpriseDialogs при этом должны быть отключены.
</p>

<p class="paragraph">
Пример загрузки внешней компоненты SimpleDllLoader.dll без регистрации в реестре с помощью vkloader.dll (эту компоненту см. здесь: <a href="http://openconf.1cpp.ru/vk/vkloader/index.html">http://openconf.1cpp.ru/vk/vkloader/index.html</a>):
</p>

<span style="color:navy; font-weight:bold">
<pre>
ЗагрузитьВнешнююКомпоненту("vkloader.dll");
ЗагрузчикВК = СоздатьОбъект("ЗагрузчикВК"); 
ЗагрузчикВК.ЗагрузитьВК("SimpleDllLoader.dll","Addin.SimpleDllLoader=0062aee4-ace8-473f-b384-f544af1e7974");
ЗагрузчикДЛЛ = СоздатьОбъект("AddIn.SimpleDllLoader");
ЗагрузчикДЛЛ.ЗагрузитьБиблиотеку(КаталогИБ()+"fdsubst.dll");
</pre>
</span>

<h2 style="text-indent:1.3em">Версия 3.0.1.6</h2>

<p class="paragraph">
Вы можете скачать плагин на <a href="http://infostart.ru/projects/456/">инфостарте</a> или <a href="fdsubst_3016.rar">здесь</a> (версия 3.0.1.6 от 23.10.2007, 57 793 байт).
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>
версия 3.0.1.6 (23.10.2007)
<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>исправлено определение Каталога ИБ в Windows Vista</LI>
<LI>исправлено положение меню избранного в Windows Vista</LI>
</UL>
</LI>
<LI>
версия 3.0.1.5 (22.07.2007):
<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>теперь работает в Win2003 и висте</LI>
<LI>иконка на кнопке "избранное" сделана прозрачной</LI>
</UL>
</LI>
<LI>
версия 3.0.1.4 (22.06.2007):
<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>иногда неверно определялся КаталогИБ в Win 2003</LI>
<LI>устранён баг с диалогами инсталляторов 1с-ных конфигураций</LI>
<LI>добавлена опция "не показывать иконку в трее" (ключ реестра "HideTrayIcon" = "1")</LI>
</UL>
</LI>
</UL>

<p style="text-align:right">
<small>Людоговский Александр</small>
</p>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>

<p><small>&copy; 2007 <A HREF='http://www.script-coding.com/'>http://www.script-coding.com</A> При любом использовании материалов сайта обязательна <b>ссылка</b> на него как на источник информации, а также сохранение <b>целостности</b> и <b>авторства</b> материалов.</small>



</body></html>