<html><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<meta http-equiv="Content-Script-Type" content="text/javascript">
<title>SubSystems</title>
<meta name="keywords" content="плагин Подсистемы SubSystems OpenConf 1С:Предприятие">
<meta name="description" content="Плагин 'Подсистемы' для платформы OpenConf">
<style type="text/css"> 
	.paragraph {text-align:justify; text-indent:2em; margin-top:0; margin-bottom:0}
</style>
</head>
<body bgcolor=#E0E0E0>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>
<p><a href="http://forum.script-coding.com">ФОРУМ (здесь можно обсудить эту статью, а также любые
проблемы программирования на различных макроязыках и в скриптовых средах)</a></p>

<h1>Плагин Подсистемы для платформы OpenConf</h1>

<p class="paragraph">
Оглавление:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI><a href="#_1">Назначение и установка плагина</a></LI>
<LI><a href="#_2">Работа с конфигурациями и подконфигурациями</a></LI>
<LI><a href="#_3">Работа с подсистемами</a></LI>
<LI><a href="#_4">Работа с метаданными</a></LI>
<LI><a href="#_5">Работа со списком задач</a></LI>
<LI><a href="#_6">Работа с шаблонами</a></LI>
<LI><a href="#_7">Некоторые замеченные проблемы</a></LI>
<LI><a href="#_8">Прилагаемый скрипт</a></LI>
<LI><a href="#_9">Версия 1.3.4.5</a></LI>
<LI><a href="#_10">Версия 1.3.4.6</a></LI>
<LI><a href="#_11">Версия 1.3.4.7</a></LI>
<LI><a href="#_12">Версия 1.3.4.8</a></LI>
</UL>

<h2 style="text-indent:1.3em"><a name="_1">Назначение и установка плагина</a></h2>

<p class="paragraph">
Плагин предоставляет возможности:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Механизм <i>подсистем</i>. Подсистема представляет собой выборку отдельных объектов метаданных (констант, справочников, документов и т.д.) и внешних файлов, которая может произвольно формироваться разработчиком. Один и тот же объект может быть включён одновременно в несколько подсистем. Плагин предоставляет собственное "дерево" метаданных, в котором отображаются только объекты выбранных подсистем, и только объекты указанных типов.</LI>
<LI>В дерево метаданных плагина включены дополнительные элементы и много дополнительных возможностей для быстрого просмотра и управления объектами. Есть возможность сохранить текущее дерево метаданных в текстовом файле, реализован механизм закладок в дереве метаданных.</LI>
<LI>"Встроенный" в Конфигуратор проводник Windows.</LI>
<LI>Создание и хранение специальных описаний объектов метаданных только для разработчика конфигурации.</LI>
<LI><i>Список задач</i>, с помощью которого разработчик конфигурации 1С может организовать план своей работы с  конфигурацией.</LI>
<LI>Возможность сохранения наиболее часто используемых текстовых блоков с помощью специальных <i>шаблонов</i> (не путать с шаблонами 1С). Механизм шаблонов, помимо прочего, позволяет хранить и использовать <i>шаблоны форм</i>, содержащие визуальные элементы управления для быстрой вставки на формы.</LI>
</UL>

<p class="paragraph">
Плагин можно скачать в <a href="http://1c.proclub.ru/modules/mydownloads/personal.php?lid=4558&cid=1001">клубе профессионалов 1С</a> (версия 1.3.3.3) или <a href="SubSystems.zip">здесь</a> (версия 1.3.4.4, 1 050 927 байт). Плагин написан на Delphi.
</p>

<p class="paragraph">
Автор плагина: Сергей Ушаков.
</p>

<p class="paragraph">
Чтобы установить плагин, проделайте следующее:
</p>

<OL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>Скопируйте файлы
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>SubSystems.dll</LI>
<LI>SubSystemsData.mdb</LI>
</UL>
в подкаталог <b>\BIN\Config\</b> каталога установки 1С:Предприятия. Файл <b>SubSystems.dll</b> является собственно плагином. Файл <b>SubSystemsData.mdb</b> является файлом базы данных в формате Microsoft Access, в которой хранится вся информация о настройках <i>Подсистем</i>, <i>Списка задач</i> и <i>Шаблонов</i>. В этой базе данных будет храниться информация обо всех конфигурациях, в работе с которыми будет применяться плагин. Файл <b>SubSystemsData.mdb</b> в принципе может иметь другое имя и располагаться где угодно. В случае, если вы хотите расположить этот файл в другом месте и/или переименовать его (и только в этом случае), вам необходимо поместить в вышеупомянутый каталог <b>\BIN\Config\</b> файл <b>SubSystemsData.ini</b>, который должен содержать строку подключения к mdb-базе данных плагина. Пример строки подключения:
<span style="color:navy; font-weight:bold;">
<pre>
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=D:\MyData.mdb;Persist Security Info=False
</pre>
</span>
Вы можете сформировать такую строку подключения в полуавтоматическом режиме, используя файл <b>.udl</b>. Создайте в любом месте пустой udl-файл с произвольным именем и откройте его двойным щелчком. В открывшемся диалоге выберите провайдера <b>Microsoft.Jet.OLEDB.4.0</b> и mdb-файл базы данных. При нажатии кнопки "ОК" строка подключения будет сформирована автоматически. Прочитать сформированную строку подключения вы сможете, открыв udl-файл после произведения вышеуказанных действий, например, в блокноте (.udl - это текстовый файл).
</LI>

<LI>Скопируйте файл <b>SubSystemsManage.vbs</b> в подкаталог <b>\BIN\Config\scripts\SubSystems\</b> каталога установки 1С:Предприятия. Полный путь к этому каталогу может выглядеть, например, так:
<span style="color:navy; font-weight:bold;">
<pre>
C:\Program Files\1Cv77\BIN\config\scripts\SubSystems\
</pre>
</span>
Примечание: в принципе, папку "SubSystems" можно и не создавать, положив скрипты прямо в "config\scripts\". Однако, кроме этих скриптов, для OpenConf существуют и другие скрипты, и хорошо организованная структура папок вам пригодится.
</LI>

<LI>Перезапустите Конфигуратор, если он был запущен. Откройте окно конфигурации (меню "Конфигурация" - "Открыть конфигурацию"). Если кроме закладок "Метаданные", "Интерфейсы", "Права" и "OpenConf" вы видите закладку "Подсистемы", установка прошла успешно.</LI>

<LI>После установки плагина на закладке "Подсистемы" окна конфигурации вы должны увидеть единственную закладку "Метаданные". Здесь вверху есть панель инструментов, и шестая кнопка слева на этой панели вызывает диалог настройки параметров. Данный диалог управляет видимостью многочисленных закладок плагина (с помощью установки флажков). Устанавливая различные флажки, просмотрите, какие есть закладки, чтобы освоиться с плагином. Настройка видимости закладок запоминается для каждой конфигурации (информационной базы).</LI>

<LI>Вы можете при желании использовать <i>панель</i> плагина. Для этого откройте окно "Настройка панелей" через меню "OpenConf" - "Настройка панелей...", добавьте новую панель, задайте ей имя ("Подсистемы") и переместите в неё доступный плагин "Подсистемы". Нажмите "ОК" и перезапустите Конфигуратор. Вы можете в любой момент отобразить или спрятать панель "Подсистемы" с помощью контекстного меню, которое появляется при щелчке правой кнопки мыши по любой панели инструментов Конфигуратора или по панели окон. Если вы создали эту панель, вкладки "Подсистемы" в окне конфигурации уже не будет, а весь интерфейс плагина будет на панели. Панель удобно использовать в режиме "Перемещать в главном окне", развернув её при этом во весь экран. Команда "Перемещать в главном окне" доступна в контекстном меню панели (на этой команде появляется или пропадает флажок).</LI>

<LI>Скопируйте файл <b>ClipboardHistory.exe</b> в любой каталог на жёстком диске, например
<span style="color:navy; font-weight:bold;">
<pre>
C:\Program Files\1Cv77\BIN\config\system\
</pre>
</span>
Данная программа следит за буфером обмена и сохраняет в файл историю копирования (последние 50 копирований текстов или <i>элементов форм 1С</i>). Для работы с шаблонами в плагине программа должна быть запущена (её окно может быть свёрнуто в трей). В скрипте <b>SubSystemsManage.vbs</b> в процедуре <b>Init</b> необходимо прописать путь к файлу <b>SaveData.tmp</b>, который будет создан автоматически. Такая запись в скрипте может выглядеть, например, так:
<span style="color:navy; font-weight:bold;">
<pre>
vTemplates.ImportFileName = "C:\Program Files\1Cv77\BIN\config\system\SaveData.tmp"
</pre>
</span>
При работе программы ClipboardHistory.exe в её каталоге создаются файлы <b>Data.xml</b> (лог всех копирований) и <b>SaveData.tmp</b> (текстовое представление последнего содержимого буфера обмена). Подробнее о работе с этой программой - см. раздел "Работа с шаблонами".
</LI>

</OL>

<h2 style="text-indent:1.3em"><a name="_2">Работа с конфигурациями и подконфигурациями</a></h2>

<p class="paragraph">
Отобразите вкладку плагина "Конфигурации" с помощью диалога "Параметры", если эта вкладка ещё не отображена, и перейдите на неё. Для начала использования плагина в любой конфигурации необходимо зарегистрировать эту конфигурацию. Чтобы это сделать, нужно добавить текущую конфигурацию в список. Кнопки панели инструментов на вкладке "Конфигурации" плагина позволяют:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Зарегистрировать (добавить) текущую конфигурацию в список.</LI>
<LI>Изменить обозначение (наименование) и описание зарегистрированной конфигурации.</LI>
<LI>Удалить конфигурацию из списка зарегистрированных конфигураций.</LI>
<LI>Обновить список зарегистрированных конфигураций (если работа ведётся в нескольких конфигурациях одновременно или после изменения наименования конфигурации).</LI>
</UL>

<p class="paragraph">
Порядок следования зарегистрированных конфигураций в списке можно регулировать, изменяя наименования конфигураций.
</p>

<p class="paragraph">
Вы можете создать <i>подконфигурации</i> для каждой зарегистрированной конфигурации ("подчинённый" список ниже). Состав кнопок панели инструментов для списка подконфигураций полностью аналогичен составу кнопок для списка конфигураций (можно добавить, изменить, удалить подконфигурацию, а также обновить список подконфигураций). Примечание: при изменении текущей конфигурации в верхнем списке нижний список необходимо обновить соответствующей кнопкой. В дальнейшем, при создании <i>подсистем</i>, вы сможете отнести создаваемую подсистему к конкретной <i>подконфигурации</i> или к конфигурации в целом. Также, к конкретной подконфигурации могут относиться и некоторые другие создаваемые при работе с плагином объекты.
</p>

<p class="paragraph">
Идея <i>подконфигураций</i> заключается в следующем: если имеется, скажем, типовая конфигурация 1С "Бухгалтерский учёт", то на базе данной конфигурации могут иметься подконфигурации – например, рабочая, которая уже эксплуатируется, и "девелоперская", где работают только разработчики (дорабатывают и обкатывают решение). Иначе говоря, идея подконфигураций служит для работы с множеством конфигураций, имеющих одного предка. В терминах плагина <i>конфигурацией</i> в этом случае будет типовая конфигурация, а <i>подконфигурациями</i> – "рабочая" и "девелоперская" конфигурации. Механизм подконфигураций даст возможность использовать общие подсистемы, отнесённые к конфигурации в целом.
</p>

<p class="paragraph">
С помощью кнопки с флажком можно указать (определить) только что добавленную (под)конфигурацию в списке как <i>рабочую</i> (она будет помечена особой пиктограммой). При следующем запуске Конфигуратора (под)конфигурация текущей информационной базы 1С будет определена как рабочая <i>автоматически</i>. При работе с подсистемами и метаданными (см. разделы ниже) используется именно <i>рабочая</i> (под)конфигурация.
</p>

<p class="paragraph">
<i>Путь</i>, который указывается при создании <i>подконфигурации</i>, служит для её идентификации. Для <i>конфигурации</i> идентификация осуществляется по <i>идентификатору</i> конфигурации (как он задан в свойствах корневого элемента стандартного дерева метаданных Конфигуратора), который задаётся в плагине как <i>наименование</i> конфигурации. Таким образом, механизм подконфигураций использовать в принципе не обязательно, но, если имеется несколько конфигураций с одинаковым идентификатором, имеющих одного предка, использование этого механизма позволит избежать путаницы.
</p>

<h2 style="text-indent:1.3em"><a name="_3">Работа с подсистемами</a></h2>

<p class="paragraph">
Отобразите вкладку плагина "Настройка" с помощью диалога "Параметры", если эта вкладка ещё не отображена, и перейдите на неё. Вкладка плагина "Настройка" сама имеет ряд вкладок (отображаются наверху):
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>
Вкладка "Подсистемы" отображает список <i>подсистем</i> и с помощью кнопок своей панели инструментов позволяет создавать, изменять, удалять подсистемы, а также обновлять список подсистем. Важно: в случае удаления подсистемы уже невозможно будет восстановить ее <i>состав</i>. Каждая подсистема может быть отнесена к конкретной <i>подконфигурации</i>. Выпадающий список на панели инструментов позволяет фильтровать список подсистем по принадлежности к той или иной подконфигурации <i>рабочей конфигурации</i> (или получить список всех подсистем рабочей конфигурации).
</LI>

<LI>
Вкладка "Настройка объектов метаданных" позволяет настроить состав каждой подсистемы, т.е. указать, какие <i>объекты метаданных</i> относятся к данной подсистеме. По нажатию единственной кнопки обновления на панели инструментов будет выведено дерево метаданных конфигурации текущей информационной базы 1С. При позиционировании на конкретном объекте метаданных на <i>панели подсистем</i>, которая может располагаться в правой или нижней части окна, будет отображаться список доступных в данной конфигурации подсистем в виде флажков, которыми и производится включение объектов метаданных в эти подсистемы. Примечание: расположение панели подсистем (в правой или нижней части окна) регулируется в диалоге "Параметры", который доступен на вкладке плагина "Метаданные". Возможен <i>множественный</i> выбор объектов метаданных с помощью мыши при нажатой клавише <i>Ctrl</i>.
</LI>

<LI>
Вкладка "Настройка состава внешних форм" позволяет включать в состав каждой подсистемы различные внешние файлы (аналогично включению в состав подсистемы объектов метаданных). Включать можно как отдельные файлы, так и целые каталоги, причем для каталогов можно указать маски включения и исключения, с помощью которых будет проводиться фильтрация файлов. С помощью кнопок панели инструментов этой вкладки можно обновить список внешних файлов, добавить в список каталог или файл, изменить или удалить текущую строку списка. В масках включения и исключения допустимо применение символов <b>?</b> (один символ) и <b>*</b> (несколько символов).
</LI>

<LI>
Вкладки "Релизы" (релизы конфигураций), "Статусы" (статусы задач) и "Пользователи" (пользователи конфигуратора) содержат информацию, используемую в списке <i>Задач</i> (см. соответствующий раздел ниже).
</LI>

</UL>

<h2 style="text-indent:1.3em"><a name="_4">Работа с метаданными</a></h2>

<p class="paragraph">
Основная работа с плагином осуществляется на вкладке "Метаданные". Здесь может быть отображена панель "Доп. информация" с множеством своих вкладок. Отобразите панель "Доп. информация" и нужные вкладки на ней с помощью диалога "Параметры" (там же можно определить положение панели - справа или внизу).
</p>

<p class="paragraph">
Перед началом работы нужно выбрать подсистемы, с которыми собираемся работать. Для этого нужно перейти на вкладку "Доступные подсистемы" панели "Доп. информация". Выборочное включение подсистем для работы осуществляется включением одноимённых флажков. С помощью панели инструментов на данной вкладке можно обновить список доступных подсистем, выбрать все доступные подсистемы, отменить выбор всех доступных подсистем, инвертировать выбор подсистем и отфильтровать список подсистем по принадлежности к <i>подконфигурации</i>.
</p>

<p class="paragraph">
После выбора нужных подсистем можно настроить отображение нужных типов метаданных, которые будут отображаться в "дереве" объектов. Для этого нужно перейти на вкладку "Отображать объекты" панели "Доп. информация". На ней приводится перечень всех типов метаданных 1С:Предприятия 7.7. Выбор нужных метаданных осуществляется с помощью включения (отключения) одноимённых флажков. С помощью панели инструментов на данной вкладке можно выбрать все доступные типы метаданных, отменить или инвертировать выбор.
</p>

<p class="paragraph">
Визуально состав "дерева" метаданных плагина несколько отличается от стандартного "дерева" метаданных 1С, и в него включены дополнительные элементы и возможности управления объектами:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>В дерево включены Глобальный модуль и Общие таблицы.</LI>
<LI>В дерево включены формы, модули и описания справочников, документов, журналов и пр.</LI>
<LI>Для справочников реквизиты с сортировкой и отбором, а также периодические реквизиты выделены отдельными пиктограммами.</LI>
<LI>Для справочника – владельца отображается перечень подчиненных справочников с возможностью их оперативного открытия.</LI>
<LI>Для документа отображается перечень вводимых на его основании других документов с возможностью их оперативного открытия.</LI>
</UL>

<p class="paragraph">
После выбора подсистем, с помощью которых предполагается вести работу над конфигурацией, нужно нажать кнопку обновления на панели инструментов вкладки плагина "Метаданные" (самая левая кнопка). При этом дерево метаданных будет заполнено. Изменения структуры метаданных автоматически не отображается в дереве метаданных плагина, поэтому при каждом внесении изменении в конфигурацию необходимо обновлять информацию нажатием этой кнопки.
</p>

<p class="paragraph">
Специальный выпадающий список на панели инструментов вкладки "Метаданные" плагина позволяет отобразить названия метаданных в дереве с различной степенью подробности (только идентификатор, идентификатор + синоним и т.д.).
</p>

<p class="paragraph">
Открытие объекта метаданных может осуществляться как при двойном щелчке мышью по нужному объекту, так и при нажатии кнопки с флажком на панели инструментов, когда курсор спозиционирован на нужном объекте метаданных.
</p>

<p class="paragraph">
Плагин позволяет иметь полную информацию о метаданных, не открывая самих объектов, с помощью вкладок "Свойства", "Ссылки" и "Подсистемы объекта" панели "Доп. информация". На вкладке "Ссылки" отображается информация о ссылках на текущий объект метаданных во всех объектах метаданных конфигурации. По своей сути это аналогично стандартной опции "Поиск ссылок на объект…" в меню "Действия". На этой вкладке с помощью кнопок панели инструментов можно обновить список ссылок на текущий объект, а также вывести перечень ссылок на текущий объект в окно сообщений.
</p>

<p class="paragraph">
Специальная кнопка панели инструментов вкладки "Метаданные" (вторая слева) позволяет сохранить текущее дерево метаданных "развернуто" в текстовом виде на диске.
</p>

<p class="paragraph">
В дереве метаданных можно устанавливать закладки, чтобы затем быстро позиционироваться на нужном объекте метаданных. Для работы с закладками используется ряд кнопок в правой части панели инструментов. Кнопки позволяют открыть диалог навигации по закладкам, установить или удалить закладку в дереве метаданных, перейти на следующую или предыдущую закладку.
</p>

<p class="paragraph">
Реализована возможность сохранения текущих настроек с последующим их восстановлением по аналогии с тем, как это сделано в отчетах и обработках 1С. Для этого служат две самых правых кнопки панели инструментов вкладки "Метаданные" плагина. При нажатии кнопки восстановления настройки открывается диалоговое окно, в котором можно выбрать ранее сохраненную настройку, либо Last. Выбор Last восстановит состояние последнего сеанса работы. Данный способ сохранения позволяет, помимо прочего, зафиксировать перечень выбранных подсистем, с помощью которых ведется работа, и типы объектов метаданных этих подсистем, которые должны отображаться в дереве метаданных плагина.
</p>

<p class="paragraph">
Если удалить некоторые объекты метаданных, предварительно не исключив их из подсистем, то плагин расценивает создавшуюся ситуацию как критичную для дальнейшей работы. В результате этого в дереве будут отражены все типы объектов метаданных, и появится дополнительный узел, в котором будут перечислены ненайденные объекты конфигурации. Для исправления сложившейся ситуации нужно удалить из базы данных плагина ссылки на отсутствующие объекты метаданных. Это можно сделать с помощью специальных кнопок панели инструментов (третья и четвёртая слева, удаление всех ненайденных или текущего ненайденного объекта). После этого дерево метаданных будет автоматически обновлено, и информации об объектах выбранных подсистем будет отображена корректно.
</p>

<p class="paragraph">
В плагине реализована возможность быстрого доступа к Проводнику Windows, интерфейс которого вынесен на отдельную вкладку "Explorer" панели "Доп. информация". Доступно контекстное меню Проводника.
</p>

<p class="paragraph">
Вкладка "Описание" панели "Доп. информация" предназначена для создания и хранения описаний любых объектов метаданных, вплоть до реквизитов справочников и документов. Это описания, которые нужны только для разработчика конфигурации (но не для пользователя). С помощью кнопок панели инструментов этой вкладки вы можете обновить отображение описания, отредактировать (задать) описание, выгрузить описание в файл, загрузить описание из файла. Кроме того, отдельная вкладка плагина "Описания" отображает перечень всех созданных описаний (отобразите эту вкладку с помощью диалога "Параметры", если эта вкладка ещё не отображена). Панель инструментов на этой вкладке позволяет обновить список описаний, отредактировать, удалить или выгрузить в файл конкретное описание.
</p>

<h2 style="text-indent:1.3em"><a name="_5">Работа со списком задач</a></h2>

<p class="paragraph">
Отобразите вкладку плагина "Задачи" с помощью диалога "Параметры", если эта вкладка ещё не отображена, и перейдите на неё. Механизм задач служит для того, чтобы систематизировать перечень задач по настройке конфигурации, которые ставит пред собой разработчик. С помощью кнопок панели инструментов этой вкладки вы можете обновлять список задач, добавлять, редактировать и удалять задачи.
</p>

<p class="paragraph">
Задача имеет довольно большой перечень реквизитов, с помощью которых описывается ее назначение, срок выполнения, текущее состояние и пр. Помимо прочего, задача может быть привязана к подсистемам и объектам метаданных. Включение флажка <i>Done</i> расценивается как завершение задачи.
</p>

<p class="paragraph">
Список задач может быть отфильтрован по различным критериям (можно одновременно по нескольким). Панель фильтра ("Условия отбора...") может быть спрятана и отображена заново щелчком по её заголовку. Щелчок мышью по заголовку столбца списка задач сортирует данные в списке по этому столбцу.
</p>

<p class="paragraph">
Задачи могут быть связаны друг с другом с помощью указания реквизита <i>основной задачи</i>. На вкладке "Связи" формы каждой задачи отображается дерево подчинённых задач. Через это дерево можно открывать подчинённые задачи.
</p>

<h2 style="text-indent:1.3em"><a name="_6">Работа с шаблонами</a></h2>

<p class="paragraph">
Отобразите вкладку плагина "Шаблоны" с помощью диалога "Параметры", если эта вкладка ещё не отображена, и перейдите на неё. Шаблоны служат для хранения любых текстовых блоков произвольной длины (частей кода, алгоритмов, описаний и пр.).
</p>

<p class="paragraph">
Шаблоны можно группировать (создавать папки в списке). С помощью кнопок панели инструментов этой вкладки вы можете обновлять список шаблонов, добавлять, редактировать и удалять шаблоны и группы шаблонов, скопировать текст шаблона в буфер, не открывая шаблон.
</p>

<p class="paragraph">
На форме шаблона вы можете отредактировать шаблон, загрузить текст шаблона из произвольного файла, выгрузить текст в произвольный файл.
</p>

<p class="paragraph">
К плагину поставляется приложение <b>ClipboardHistory.exe</b>. Данная программа следит за буфером обмена и сохраняет в файл историю копирования (последние 50 копирований текстов и элементов форм 1С). Для работы с шаблонами в плагине программа должна быть запущена (её окно может быть свёрнуто в трей). В момент копирования создается файл <b>SaveData.tmp</b>, в котором хранится текстовое представление скопированного. Содержимое этого файла можно загрузить в шаблон при помощи кнопки "Взять из файла" на форме шаблона.
</p>

<p class="paragraph">
Только что упомянутый механизм удобен для создания и использования <i>шаблонов форм</i>. Для создания шаблона формы проделайте следующее:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Запустите <i>ClipboardHistory.exe</i>, если она ещё не запущена. Можете свернуть её окно в трей.</LI>
<LI>Откройте в Конфигураторе нужную форму, выделите необходимые элементы управления (которые и станут шаблоном) и скопируйте их в буфер обмена (Ctrl+C).</LI>
<LI>Перейдите на вкладку плагина "Шаблоны", создайте новый шаблон (откроется его форма). Нажмите на кнопку "Взять из файла". В поле "Текст" будет вставлено текстовое представление скопированных вами элементов управления. Снимите флажок "Текст модуля" и сохраните шаблон.</LI>
</UL>

<p class="paragraph">
Чтобы воспользоваться созданным шаблоном формы, проделайте следующее:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Перейдите на вкладку плагина "Шаблоны", встаньте на нужный шаблон (не открывая его) и нажмите на самую правую кнопку панели инструментов. Это приведёт к копированию содержимого шаблона в буфер обмена. Того же самого можно добиться, открыв шаблон и нажав на кнопку "В буфер" (с такой же пиктограммой) уже на форме шаблона. Примечание: если в шаблоне установлен флажок "Текст модуля", при взятии в буфер значения данного шаблона не будет происходить его конвертация в элементы формы, если же флажок снят - произойдёт конвертация (именно это нам сейчас и нужно).</LI>
<LI>Откройте в Конфигураторе нужную форму и вставьте содержимое буфера (Ctrl+V). На форме появятся элементы управления.</LI>
</UL>

<h2 style="text-indent:1.3em"><a name="_7">Некоторые замеченные проблемы</a></h2>

<p class="paragraph">
Если какая-либо вкладка плагина активна и находится на переднем плане, нажатие кнопки сохранения, которая находится на панели инструментов "Стандартная", приводит к сбою в работе и "вылету" Конфигуратора. То же самое происходит при нажатии Ctrl+S или выборе меню "Файл" - "Сохранить", "Сохранить как", "Закрыть".
</p>

<p class="paragraph">
Иногда возникают проблемы при обновлении (перерисовке) отображаемой плагином информации после открытия различных диалоговых окон. В этом случае можно запустить макрос <b>RefreshSubsystemsPage</b> скрипта <b>SubSystemsManage.vbs</b> (этому макросу можно назначить удобное сочетание клавиш средствами OpenConf), или просто выбрать мышью другую закладку, а затем вернуться обратно.
</p>

<h2 style="text-indent:1.3em"><a name="_8">Прилагаемый скрипт</a></h2>

<p class="paragraph">
Все установленные скрипты содержат макросы (состав макросов вы можете изучить в дереве на вкладке OpenConf окна конфигурации), каждому из которых вы можете назначить сочетание клавиш через меню "OpenConf" - "Макросы" - "Клавиатура...". Вы можете запустить любой макрос и вручную, находясь в любом режиме работы, нажав Ctrl+M и выбрав нужный макрос в специальном диалоговом окне.
</p>

<p class="paragraph">
Скрипт <b>SubSystemsManage.vbs</b> ("Плагин: Подсистемы - управление") обязателен для корректной работы плагина, т.к. обрабатывает события плагина. Кроме того, скрипт содержит полезные макросы:
</p>

<br>
<TABLE border="1" width="100%" cellspacing="0">
<TR><TH>Макрос</TH><TH>Описание</TH></TR>

<TR>
<TD>EnableDisableSubsystems</TD>
<TD>Отображает / прячет панель "Подсистемы", если эта панель существует (см. п.5 раздела "Назначение и установка плагина").</TD>
</TR>

<TR>
<TD>RefreshSubsystemsPage</TD>
<TD>Перерисовывает текущую вкладку плагина (см. раздел "Некоторые замеченные проблемы").</TD>
</TR>

</TABLE>

<h2 style="text-indent:1.3em"><a name="_9">Версия 1.3.4.5</a></h2>

<p class="paragraph">
Версия плагина 1.3.4.5 доступна для скачивания <a href="Subsystems1345.zip">здесь</a> (1 595 291 байт). Новое в версии:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>Обновление версии:
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Для обновления структуры mdb-базы данных плагина запустите <b>StructureUpdater.exe</b> и укажите путь к mdb-файлу. Примечание: начиная с этого релиза, в плагине не будет производиться реструктуризация БД при запуске, но это будет делаться отдельным приложением StructureUpdater.exe. Таким образом, увеличится скорость загрузки конфигуратора, т.к. система не будет каждый раз сверять структуру БД. На всякий случай в архиве есть заготовка mdb-файла данных с правильной структурой таблиц.
</LI>
<LI>При необходимости вручную исправьте <b>SubSystemsData.ini</b>. Вручную замените файлы <b>SubSystems.dll</b> и <b>SubSystemsManage.vbs</b> на соответствующие файлы из архива. При необходимости в скрипте SubSystemsManage.vbs в процедуре Init заново пропишите путь к файлу SaveData.tmp (см. раздел <a href="#_1">Назначение и установка плагина</a>).</LI>
</UL>
</LI>

<LI>Исправлен ряд мелких ошибок интерфейса.</LI>

<LI>На вкладке плагина "Метаданные", если не выбрана ни одна подсистема, формируется полное дерево метаданных.</LI>

<LI>На вкладке плагина "Метаданные" в панели "Доп. информация..." добавлена вкладка "Задачи по объекту" (её можно отобразить, установив соответствующий флажок в диалоге "Параметры"). При выборе объекта метаданных на этой вкладке отображается дерево задач, связанных с данным объектом.</LI>

<LI>Расширен состав реквизитов объекта <i>Задача</i>. На вкладке плагина "Настройка" добавлены вкладки со списками новых объектов, являющихся реквизитами Задачи.</LI>

<LI>На вкладке плагина "Задачи" добавлена возможность прятать щелчком мыши нижнюю панель, которая содержит дерево подчиненных задач для текущей задачи в списке. Если не выбран вариант отображения колонок, список задач отображается с колонками ID и Наименование.</LI>

</UL>

<h2 style="text-indent:1.3em"><a name="_10">Версия 1.3.4.6</a></h2>

<p class="paragraph">
Версия плагина 1.3.4.6 доступна для скачивания <a href="Subsystems1346.zip">здесь</a> (1 681 004 байт). Новое в версии:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">

<LI>Обновление версии:
<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Для обновления структуры mdb-базы данных плагина запустите <b>StructureUpdater.exe</b> и укажите путь к mdb-файлу.
</LI>
<LI>При необходимости вручную исправьте <b>SubSystemsData.ini</b>. Вручную замените файлы <b>SubSystems.dll</b> и <b>SubSystemsManage.vbs</b> на соответствующие файлы из архива. При необходимости в скрипте SubSystemsManage.vbs в процедуре Init заново пропишите путь к файлу SaveData.tmp (см. раздел <a href="#_1">Назначение и установка плагина</a>). Скопируйте файл <b>SubsystemsReports.js</b> в ту же папку, где находится файл <i>SubSystemsManage.vbs</i>.</LI>
</UL>
</LI>

<LI>Ряд мелких интерфейсных поправок, в т.ч. отображение в дереве метаданных общих реквизитов документов.</LI>

<LI>Регистрация изменений объектов метаданных. Производится на новой вкладке "Изменения" в панели "Доп. информация" на вкладке плагина "Метаданные". Отобразить нужные вкладки на панели "Доп. информация" можно с помощью диалога "Параметры" (шестая кнопка слева на панели инструментов вкладки плагина "Метаданные" вызывает диалог настройки параметров).</LI>

<LI>Управление "блокировками" объектов метаданных (для коллективной работы над конфигурацией). Чтобы "заблокировать" объект, установите курсор на нужный объект в дереве метаданных на вкладке плагина "Метаданные" и вызовите макрос <b>SetMDObjBlock</b> скрипта <b>SubSystemsManage.vbs</b>. Откроется окно "Блокировка объекта МД", где можно указать необходимые параметры. В дальнейшем "заблокированные" объекты метаданных отображаются на вкладке плагина "Блокировки", где можно при желании удалить ставшие ненужными "блокировки" (отобразить эту вкладку можно с помощью диалога "Параметры"). Кроме того, "заблокированные" объекты метаданных могут отображаться специальными пиктограммами в дереве метаданных плагина. Для этого служит настройка
<span style="color:navy; font-weight:bold;">
<pre>
vListMDObjBlocks.ShowBlocks 1 'если 0 - не отображать
</pre>
</span>
в процедуре <b>Init</b> скрипта <b>SubSystemsManage.vbs</b>.
</LI>

<LI>Макрос <b>GetSQLData</b> скрипта <b>SubsystemsReports.js</b> выводит список существующих задач с планируемой датой начала выполнения, большей или равной текущей дате, в виде HTML-отчёта (т.е. список будущих задач).</LI>

</UL>

<h2 style="text-indent:1.3em"><a name="_11">Версия 1.3.4.7</a></h2>

<p class="paragraph">
Версия плагина 1.3.4.7 доступна для скачивания <a href="Subsystems1347.zip">здесь</a> (2 127 839 байт). Кроме того, информация о плагине и его обновления выкладываются <a href="http://phoenixusa.narod.ru/Subsystems.htm">на этой страничке</a>.
</p>

<p class="paragraph">
Обновление версии в целом аналогично предыдущим обновлениям. Обновите файл <b>SubSystems.dll</b> и файлы скриптов, для обновления структуры mdb-базы данных плагина запустите <b>StructureUpdater.exe</b> и укажите путь к mdb-файлу.
</p>

<p class="paragraph">
Новое в версии:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5;">
<LI>Разворот реквизитов составных (непримитивных) типов в дереве метаданных. По нажатию <b>Ctrl+Enter</b> на реквизите он превращается в ветвь дерева, которую можно раскрыть. Информация выводится так же, как и в любой другой аналогичной ветви дерева.</LI>
<LI>Интеллектуальный вывод данных в дереве. Не выводится ветка для реквизитов, если реально нет реквизитов, не выводится форма элемента, если справочник редактируется в списке.</LI>
<LI>Отображение специальными иконками объектов МД, прописанных в turbomd.prm.</LI>
<LI>Возможность указания пути относительно каталога ИБ при настройке состава внешних форм (вкладка плагина "Настройка" - "Внешние формы").</LI>
<LI>Отображение подконфигурации, к которой привязана подсистема, при выводе списка подсистем в различных местах плагина.</LI>
<LI>Отображение внешних печатных форм для справочников/документов (анализ файлов *.efd в каталоге \ExtForms\PrnForms\). Если к справочнику/документу подключены внешние печатные формы, в дереве метаданных плагина в ветке этого справочника/документа выводится подветка "Печатные формы".</LI>
<LI>Приведено соответствие иконок стандартным 1С-ким почти для всех объектов.</LI>
<LI>Исправлены некоторые ошибки.</LI>
</UL>

<h2 style="text-indent:1.3em"><a name="_12">Версия 1.3.4.8</a></h2>

<p class="paragraph">
Версия плагина 1.3.4.8 доступна для скачивания <a href="Subsystems1348.zip">здесь</a> (2 127 839 байт). Кроме того, информация о плагине и его обновления выкладываются <a href="http://phoenixusa.narod.ru/Subsystems.htm">на этой страничке</a>.
</p>

<p class="paragraph">
Обновление версии в целом аналогично предыдущим обновлениям. Обновите файл <b>SubSystems.dll</b> и файлы скриптов, для обновления структуры mdb-базы данных плагина запустите <b>StructureUpdater.exe</b> и укажите путь к mdb-файлу.
</p>

<p class="paragraph">
Новое в версии:
</p>

<UL style="text-indent:0em; margin-top:5; margin-bottom:5">
<LI>Кнопка на панели инструментов для разворота реквизитов составных (непримитивных) типов в дереве метаданных. (раньше это работало только по нажатию Ctrl+Enter).</LI>
<LI>Условия на дерево подчиненных задач в списке задач: накладываются те же условия, что и на список.</LI>
</UL>

<p style="text-align:right">
<small>Людоговский Александр</small>
</p>

<p><a href="index.html">Перейти на главную страничку сайта (список статей, файлы для скачивания)</a></p>

<p><small>&copy; 2007 <A HREF='http://www.script-coding.com/'>http://www.script-coding.com</A> При любом использовании материалов сайта обязательна <b>ссылка</b> на него как на источник информации, а также сохранение <b>целостности</b> и <b>авторства</b> материалов.</small>



</body></html>